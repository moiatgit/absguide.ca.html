

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>XXX Appendix M. Sample `` .bashrc `` and `` .bash_profile `` Files &mdash; Guia Avançada de Programació Bash 10 març de 2014 documentació</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="copyright" title="Copyright" href="copyright.html"/>
    <link rel="top" title="Guia Avançada de Programació Bash 10 març de 2014 documentació" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Guia Avançada de Programació Bash
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Cercar..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="part1.html">Part 1. Introducció</a></li>
<li class="toctree-l1"><a class="reference internal" href="part2.html">Part 2. Conceptes bàsics</a></li>
<li class="toctree-l1"><a class="reference internal" href="part3.html">XXX Part 3. Beyond the Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="part4.html">XXX Part 4. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="part5.html">XXX Part 5. Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="endnotes.html">Notes finals</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">XXX  Bibliografia</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Guia Avançada de Programació Bash</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Inici</a> &raquo;</li>
      
    <li>XXX  Appendix M. Sample ``      .bashrc     `` and ``      .bash_profile     `` Files</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="xxx-appendix-m-sample-bashrc-and-bash-profile-files">
<h1>XXX  Appendix M. Sample ``      .bashrc     `` and ``      .bash_profile     `` Files<a class="headerlink" href="#xxx-appendix-m-sample-bashrc-and-bash-profile-files" title="Link permanent a aquest títol">¶</a></h1>
<p>The ``      ~/.bashrc     `` file determines the behavior of interactive
shells. A good look at this file can lead to a better understanding of
Bash.</p>
<p><a class="reference external" href="mailto:emmanuel&#46;rouat&#37;&#52;&#48;wanadoo&#46;fr">Emmanuel Rouat</a> contributed the
following very elaborate ``      .bashrc     `` file, written for a
Linux system. He welcomes reader feedback on it.</p>
<p>Study the file carefully, and feel free to reuse code snippets and
functions from it in your own ``      .bashrc     `` file or even in
your scripts.</p>
<div class="section" id="exemple-1-sample-bashrc-file">
<h2>Exemple 1. Sample ``        .bashrc       `` file<a class="headerlink" href="#exemple-1-sample-bashrc-file" title="Link permanent a aquest títol">¶</a></h2>
<div class="highlight-sh"><div class="highlight"><pre><span class="c"># =============================================================== #</span>
<span class="c">#</span>
<span class="c"># PERSONAL $HOME/.bashrc FILE for bash-3.0 (or later)</span>
<span class="c"># By Emmanuel Rouat [no-email]</span>
<span class="c">#</span>
<span class="c"># Last modified: Tue Nov 20 22:04:47 CET 2012</span>

<span class="c">#  This file is normally read by interactive shells only.</span>
<span class="c">#+ Here is the place to define your aliases, functions and</span>
<span class="c">#+ other interactive features like your prompt.</span>
<span class="c">#</span>
<span class="c">#  The majority of the code here assumes you are on a GNU</span>
<span class="c">#+ system (most likely a Linux box) and is often based on code</span>
<span class="c">#+ found on Usenet or Internet.</span>
<span class="c">#</span>
<span class="c">#  See for instance:</span>
<span class="c">#  http://tldp.org/LDP/abs/html/index.html</span>
<span class="c">#  http://www.caliban.org/bash</span>
<span class="c">#  http://www.shelldorado.com/scripts/categories.html</span>
<span class="c">#  http://www.dotfiles.org</span>
<span class="c">#</span>
<span class="c">#  The choice of colors was done for a shell with a dark background</span>
<span class="c">#+ (white on black), and this is usually also suited for pure text-mode</span>
<span class="c">#+ consoles (no X server available). If you use a white background,</span>
<span class="c">#+ you&#39;ll have to do some other choices for readability.</span>
<span class="c">#</span>
<span class="c">#  This bashrc file is a bit overcrowded.</span>
<span class="c">#  Remember, it is just just an example.</span>
<span class="c">#  Tailor it to your needs.</span>
<span class="c">#</span>
<span class="c"># =============================================================== #</span>

<span class="c"># --&gt; Comments added by HOWTO author.</span>

<span class="c"># If not running interactively, don&#39;t do anything</span>
<span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$PS1</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="k">return</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Source global definitions (if any)</span>
<span class="c">#-------------------------------------------------------------</span>


<span class="k">if</span> <span class="o">[</span> -f /etc/bashrc <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
      . /etc/bashrc   <span class="c"># --&gt; Read /etc/bashrc, if present.</span>
<span class="k">fi</span>


<span class="c">#--------------------------------------------------------------</span>
<span class="c">#  Automatic setting of $DISPLAY (if not set already).</span>
<span class="c">#  This works for me - your mileage may vary. . . .</span>
<span class="c">#  The problem is that different types of terminals give</span>
<span class="c">#+ different answers to &#39;who am i&#39; (rxvt in particular can be</span>
<span class="c">#+ troublesome) - however this code seems to work in a majority</span>
<span class="c">#+ of cases.</span>
<span class="c">#--------------------------------------------------------------</span>

<span class="k">function</span> get_xserver <span class="o">()</span>
<span class="o">{</span>
    <span class="k">case</span> <span class="nv">$TERM</span> in
        xterm <span class="o">)</span>
            <span class="nv">XSERVER</span><span class="o">=</span><span class="k">$(</span>who am iawk <span class="s1">&#39;{print $NF}&#39;</span> <span class="p">|</span> tr -d <span class="s1">&#39;)&#39;&#39;(&#39;</span> <span class="k">)</span>
            <span class="c"># Ane-Pieter Wieringa suggests the following alternative:</span>
            <span class="c">#  I_AM=$(who am i)</span>
            <span class="c">#  SERVER=${I_AM#*(}</span>
            <span class="c">#  SERVER=${SERVER%*)}</span>
            <span class="nv">XSERVER</span><span class="o">=</span><span class="si">${</span><span class="nv">XSERVER</span><span class="p">%%:*</span><span class="si">}</span>
            <span class="p">;;</span>
            atermrxvt<span class="o">)</span>
            <span class="c"># Find some code that works here. ...</span>
            <span class="p">;;</span>
    <span class="k">esac</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="si">${</span><span class="nv">DISPLAY</span><span class="p">:=</span><span class="s2">&quot;&quot;</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    get_xserver
    <span class="k">if</span> <span class="o">[[</span> -z <span class="si">${</span><span class="nv">XSERVER</span><span class="si">}</span>  <span class="p">|</span><span class="si">${</span><span class="nv">XSERVER</span><span class="si">}</span> <span class="o">==</span> <span class="k">$(</span>hostname<span class="k">)</span> <span class="p">|</span>
       <span class="si">${</span><span class="nv">XSERVER</span><span class="si">}</span> <span class="o">==</span> <span class="s2">&quot;unix&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
          <span class="nv">DISPLAY</span><span class="o">=</span><span class="s2">&quot;:0.0&quot;</span>          <span class="c"># Display on local host.</span>
    <span class="k">else</span>
       <span class="nv">DISPLAY</span><span class="o">=</span><span class="si">${</span><span class="nv">XSERVER</span><span class="si">}</span>:0.0     <span class="c"># Display on remote host.</span>
    <span class="k">fi</span>
<span class="k">fi</span>

<span class="nb">export </span>DISPLAY

<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Some settings</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="c">#set -o nounset     # These  two options are useful for debugging.</span>
<span class="c">#set -o xtrace</span>
<span class="nb">alias </span><span class="nv">debug</span><span class="o">=</span><span class="s2">&quot;set -o nounset; set -o xtrace&quot;</span>

<span class="nb">ulimit</span> -S -c <span class="m">0</span>      <span class="c"># Don&#39;t want coredumps.</span>
<span class="nb">set</span> -o notify
<span class="nb">set</span> -o noclobber
<span class="nb">set</span> -o ignoreeof


<span class="c"># Enable options:</span>
<span class="nb">shopt</span> -s cdspell
<span class="nb">shopt</span> -s cdable_vars
<span class="nb">shopt</span> -s checkhash
<span class="nb">shopt</span> -s checkwinsize
<span class="nb">shopt</span> -s sourcepath
<span class="nb">shopt</span> -s no_empty_cmd_completion
<span class="nb">shopt</span> -s cmdhist
<span class="nb">shopt</span> -s histappend histreedit histverify
<span class="nb">shopt</span> -s extglob       <span class="c"># Necessary for programmable completion.</span>

<span class="c"># Disable options:</span>
<span class="nb">shopt</span> -u mailwarn
<span class="nb">unset </span>MAILCHECK        <span class="c"># Don&#39;t want my shell to warn me of incoming mail.</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Greeting, motd etc. ...</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="c"># Color definitions (taken from Color Bash Prompt HowTo).</span>
<span class="c"># Some colors might look different of some terminals.</span>
<span class="c"># For example, I see &#39;Bold Red&#39; as &#39;orange&#39; on my screen,</span>
<span class="c"># hence the &#39;Green&#39; &#39;BRed&#39; &#39;Red&#39; sequence I often use in my prompt.</span>


<span class="c"># Normal Colors</span>
<span class="nv">Black</span><span class="o">=</span><span class="s1">&#39;\e[0;30m&#39;</span>        <span class="c"># Black</span>
<span class="nv">Red</span><span class="o">=</span><span class="s1">&#39;\e[0;31m&#39;</span>          <span class="c"># Red</span>
<span class="nv">Green</span><span class="o">=</span><span class="s1">&#39;\e[0;32m&#39;</span>        <span class="c"># Green</span>
<span class="nv">Yellow</span><span class="o">=</span><span class="s1">&#39;\e[0;33m&#39;</span>       <span class="c"># Yellow</span>
<span class="nv">Blue</span><span class="o">=</span><span class="s1">&#39;\e[0;34m&#39;</span>         <span class="c"># Blue</span>
<span class="nv">Purple</span><span class="o">=</span><span class="s1">&#39;\e[0;35m&#39;</span>       <span class="c"># Purple</span>
<span class="nv">Cyan</span><span class="o">=</span><span class="s1">&#39;\e[0;36m&#39;</span>         <span class="c"># Cyan</span>
<span class="nv">White</span><span class="o">=</span><span class="s1">&#39;\e[0;37m&#39;</span>        <span class="c"># White</span>

<span class="c"># Bold</span>
<span class="nv">BBlack</span><span class="o">=</span><span class="s1">&#39;\e[1;30m&#39;</span>       <span class="c"># Black</span>
<span class="nv">BRed</span><span class="o">=</span><span class="s1">&#39;\e[1;31m&#39;</span>         <span class="c"># Red</span>
<span class="nv">BGreen</span><span class="o">=</span><span class="s1">&#39;\e[1;32m&#39;</span>       <span class="c"># Green</span>
<span class="nv">BYellow</span><span class="o">=</span><span class="s1">&#39;\e[1;33m&#39;</span>      <span class="c"># Yellow</span>
<span class="nv">BBlue</span><span class="o">=</span><span class="s1">&#39;\e[1;34m&#39;</span>        <span class="c"># Blue</span>
<span class="nv">BPurple</span><span class="o">=</span><span class="s1">&#39;\e[1;35m&#39;</span>      <span class="c"># Purple</span>
<span class="nv">BCyan</span><span class="o">=</span><span class="s1">&#39;\e[1;36m&#39;</span>        <span class="c"># Cyan</span>
<span class="nv">BWhite</span><span class="o">=</span><span class="s1">&#39;\e[1;37m&#39;</span>       <span class="c"># White</span>

<span class="c"># Background</span>
<span class="nv">On_Black</span><span class="o">=</span><span class="s1">&#39;\e[40m&#39;</span>       <span class="c"># Black</span>
<span class="nv">On_Red</span><span class="o">=</span><span class="s1">&#39;\e[41m&#39;</span>         <span class="c"># Red</span>
<span class="nv">On_Green</span><span class="o">=</span><span class="s1">&#39;\e[42m&#39;</span>       <span class="c"># Green</span>
<span class="nv">On_Yellow</span><span class="o">=</span><span class="s1">&#39;\e[43m&#39;</span>      <span class="c"># Yellow</span>
<span class="nv">On_Blue</span><span class="o">=</span><span class="s1">&#39;\e[44m&#39;</span>        <span class="c"># Blue</span>
<span class="nv">On_Purple</span><span class="o">=</span><span class="s1">&#39;\e[45m&#39;</span>      <span class="c"># Purple</span>
<span class="nv">On_Cyan</span><span class="o">=</span><span class="s1">&#39;\e[46m&#39;</span>        <span class="c"># Cyan</span>
<span class="nv">On_White</span><span class="o">=</span><span class="s1">&#39;\e[47m&#39;</span>       <span class="c"># White</span>

<span class="nv">NC</span><span class="o">=</span><span class="s2">&quot;\e[m&quot;</span>               <span class="c"># Color Reset</span>


<span class="nv">ALERT</span><span class="o">=</span><span class="si">${</span><span class="nv">BWhite</span><span class="si">}${</span><span class="nv">On_Red</span><span class="si">}</span> <span class="c"># Bold White on red background</span>



<span class="nb">echo</span> -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BCyan</span><span class="si">}</span><span class="s2">This is BASH </span><span class="si">${</span><span class="nv">BRed</span><span class="si">}${</span><span class="nv">BASH_VERSION</span><span class="p">%.*</span><span class="si">}${</span><span class="nv">BCyan</span><span class="si">}</span><span class="s2">\</span>
<span class="s2">- DISPLAY on </span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span><span class="nv">$DISPLAY</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\n&quot;</span>
date
<span class="k">if</span> <span class="o">[</span> -x /usr/games/fortune <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    /usr/games/fortune -s     <span class="c"># Makes our day a bit more fun.... :-)</span>
<span class="k">fi</span>

<span class="k">function</span> _exit<span class="o">()</span>              <span class="c"># Function to run upon exit of shell.</span>
<span class="o">{</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span><span class="s2">Hasta la vista, baby</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>
<span class="nb">trap </span>_exit EXIT

<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Shell Prompt - for many examples, see:</span>
<span class="c">#       http://www.debian-administration.org/articles/205</span>
<span class="c">#       http://www.askapache.com/linux/bash-power-prompt.html</span>
<span class="c">#       http://tldp.org/HOWTO/Bash-Prompt-HOWTO</span>
<span class="c">#       https://github.com/nojhan/liquidprompt</span>
<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Current Format: [TIME USER@HOST PWD] &gt;</span>
<span class="c"># TIME:</span>
<span class="c">#    Green     == machine load is low</span>
<span class="c">#    Orange    == machine load is medium</span>
<span class="c">#    Red       == machine load is high</span>
<span class="c">#    ALERT     == machine load is very high</span>
<span class="c"># USER:</span>
<span class="c">#    Cyan      == normal user</span>
<span class="c">#    Orange    == SU to user</span>
<span class="c">#    Red       == root</span>
<span class="c"># HOST:</span>
<span class="c">#    Cyan      == local session</span>
<span class="c">#    Green     == secured remote connection (via ssh)</span>
<span class="c">#    Red       == unsecured remote connection</span>
<span class="c"># PWD:</span>
<span class="c">#    Green     == more than 10% free disk space</span>
<span class="c">#    Orange    == less than 10% free disk space</span>
<span class="c">#    ALERT     == less than 5% free disk space</span>
<span class="c">#    Red       == current user does not have write privileges</span>
<span class="c">#    Cyan      == current filesystem is size zero (like /proc)</span>
<span class="c"># &gt;:</span>
<span class="c">#    White     == no background or suspended jobs in this shell</span>
<span class="c">#    Cyan      == at least one background job in this shell</span>
<span class="c">#    Orange    == at least one suspended job in this shell</span>
<span class="c">#</span>
<span class="c">#    Command is added to the history file each time you hit enter,</span>
<span class="c">#    so it&#39;s available to all shells (using &#39;history -a&#39;).</span>


<span class="c"># Test connection type:</span>
<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;</span><span class="si">${</span><span class="nv">SSH_CONNECTION</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">CNX</span><span class="o">=</span><span class="si">${</span><span class="nv">Green</span><span class="si">}</span>        <span class="c"># Connected on remote machine, via ssh (good).</span>
<span class="k">elif</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">DISPLAY</span><span class="p">%%:</span><span class="nv">0</span><span class="p">*</span><span class="si">}</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">CNX</span><span class="o">=</span><span class="si">${</span><span class="nv">ALERT</span><span class="si">}</span>        <span class="c"># Connected on remote machine, not via ssh (bad).</span>
<span class="k">else</span>
    <span class="nv">CNX</span><span class="o">=</span><span class="si">${</span><span class="nv">BCyan</span><span class="si">}</span>        <span class="c"># Connected on local machine.</span>
<span class="k">fi</span>

<span class="c"># Test user type:</span>
<span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">USER</span><span class="si">}</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">SU</span><span class="o">=</span><span class="si">${</span><span class="nv">Red</span><span class="si">}</span>           <span class="c"># User is root.</span>
<span class="k">elif</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">USER</span><span class="si">}</span> !<span class="o">=</span> <span class="k">$(</span>logname<span class="k">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nv">SU</span><span class="o">=</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>          <span class="c"># User is not login user.</span>
<span class="k">else</span>
    <span class="nv">SU</span><span class="o">=</span><span class="si">${</span><span class="nv">BCyan</span><span class="si">}</span>         <span class="c"># User is normal (well ... most of us are).</span>
<span class="k">fi</span>



<span class="nv">NCPU</span><span class="o">=</span><span class="k">$(</span>grep -c <span class="s1">&#39;processor&#39;</span> /proc/cpuinfo<span class="k">)</span>    <span class="c"># Number of CPUs</span>
<span class="nv">SLOAD</span><span class="o">=</span><span class="k">$((</span> <span class="m">100</span><span class="o">*</span><span class="si">${</span><span class="nv">NCPU</span><span class="si">}</span> <span class="k">))</span>        <span class="c"># Small load</span>
<span class="nv">MLOAD</span><span class="o">=</span><span class="k">$((</span> <span class="m">200</span><span class="o">*</span><span class="si">${</span><span class="nv">NCPU</span><span class="si">}</span> <span class="k">))</span>        <span class="c"># Medium load</span>
<span class="nv">XLOAD</span><span class="o">=</span><span class="k">$((</span> <span class="m">400</span><span class="o">*</span><span class="si">${</span><span class="nv">NCPU</span><span class="si">}</span> <span class="k">))</span>        <span class="c"># Xlarge load</span>

<span class="c"># Returns system load as percentage, i.e., &#39;40&#39; rather than &#39;0.40)&#39;.</span>
<span class="k">function</span> load<span class="o">()</span>
<span class="o">{</span>
    <span class="nb">local </span><span class="nv">SYSLOAD</span><span class="o">=</span><span class="k">$(</span>cut -d <span class="s2">&quot; &quot;</span> -f1 /proc/loadavgtr -d <span class="s1">&#39;.&#39;</span><span class="k">)</span>
    <span class="c"># System load of the current host.</span>
    <span class="nb">echo</span> <span class="k">$((</span><span class="m">10#</span><span class="nv">$SYSLOAD</span><span class="k">))</span>       <span class="c"># Convert to decimal.</span>
<span class="o">}</span>

<span class="c"># Returns a color indicating system load.</span>
<span class="k">function</span> load_color<span class="o">()</span>
<span class="o">{</span>
    <span class="nb">local </span><span class="nv">SYSLOAD</span><span class="o">=</span><span class="k">$(</span>load<span class="k">)</span>
    <span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">SYSLOAD</span><span class="si">}</span> -gt <span class="si">${</span><span class="nv">XLOAD</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">ALERT</span><span class="si">}</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">SYSLOAD</span><span class="si">}</span> -gt <span class="si">${</span><span class="nv">MLOAD</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">Red</span><span class="si">}</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">SYSLOAD</span><span class="si">}</span> -gt <span class="si">${</span><span class="nv">SLOAD</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>
    <span class="k">else</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">Green</span><span class="si">}</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># Returns a color according to free disk space in $PWD.</span>
<span class="k">function</span> disk_color<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> ! -w <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">Red</span><span class="si">}</span>
        <span class="c"># No &#39;write&#39; privilege in the current directory.</span>
    <span class="k">elif</span> <span class="o">[</span> -s <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="nb">local </span><span class="nv">used</span><span class="o">=</span><span class="k">$(</span><span class="nb">command </span>df -P <span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">&quot;</span>
                   awk <span class="s1">&#39;END {print $5} {sub(/%/,&quot;&quot;)}&#39;</span><span class="k">)</span>
        <span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">used</span><span class="si">}</span> -gt <span class="m">95</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">ALERT</span><span class="si">}</span>           <span class="c"># Disk almost full (&gt;95%).</span>
        <span class="k">elif</span> <span class="o">[</span> <span class="si">${</span><span class="nv">used</span><span class="si">}</span> -gt <span class="m">90</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>            <span class="c"># Free disk space almost gone.</span>
        <span class="k">else</span>
            <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">Green</span><span class="si">}</span>           <span class="c"># Free disk space is ok.</span>
        <span class="k">fi</span>
    <span class="k">else</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">Cyan</span><span class="si">}</span>
        <span class="c"># Current directory is size &#39;0&#39; (like /proc, /sys etc).</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># Returns a color according to running/suspended jobs.</span>
<span class="k">function</span> job_color<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="k">$(</span><span class="nb">jobs</span> -swc -l<span class="k">)</span> -gt <span class="s2">&quot;0&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>
    <span class="k">elif</span> <span class="o">[</span> <span class="k">$(</span><span class="nb">jobs</span> -rwc -l<span class="k">)</span> -gt <span class="s2">&quot;0&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
        <span class="nb">echo</span> -en <span class="si">${</span><span class="nv">BCyan</span><span class="si">}</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># Adds some text in the terminal frame (if applicable).</span>


<span class="c"># Now we construct the prompt.</span>
<span class="nv">PROMPT_COMMAND</span><span class="o">=</span><span class="s2">&quot;history -a&quot;</span>
<span class="k">case</span> <span class="si">${</span><span class="nv">TERM</span><span class="si">}</span> in
  *termrxvt <span class="p">|</span> linux<span class="o">)</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\[\$(load_color)\][\A\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\] &quot;</span>
        <span class="c"># Time of day (with load info):</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\[\$(load_color)\][\A\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\] &quot;</span>
        <span class="c"># User@Host (with connection type info):</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="si">${</span><span class="nv">PS1</span><span class="si">}</span><span class="s2">&quot;\[</span><span class="si">${</span><span class="nv">SU</span><span class="si">}</span><span class="s2">\]\u\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\]@\[</span><span class="si">${</span><span class="nv">CNX</span><span class="si">}</span><span class="s2">\]\h\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\] &quot;</span>
        <span class="c"># PWD (with &#39;disk space&#39; info):</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="si">${</span><span class="nv">PS1</span><span class="si">}</span><span class="s2">&quot;\[\$(disk_color)\]\W]\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\] &quot;</span>
        <span class="c"># Prompt (with &#39;job&#39; info):</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="si">${</span><span class="nv">PS1</span><span class="si">}</span><span class="s2">&quot;\[\$(job_color)\]&gt;\[</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">\] &quot;</span>
        <span class="c"># Set title of current xterm:</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="si">${</span><span class="nv">PS1</span><span class="si">}</span><span class="s2">&quot;\[\e]0;[\u@\h] \w\a\]&quot;</span>
        <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;(\A \u@\h \W) &gt; &quot;</span> <span class="c"># --&gt; PS1=&quot;(\A \u@\h \w) &gt; &quot;</span>
                               <span class="c"># --&gt; Shows full pathname of current dir.</span>
        <span class="p">;;</span>
<span class="k">esac</span>



<span class="nb">export </span><span class="nv">TIMEFORMAT</span><span class="o">=</span><span class="s1">$&#39;\nreal %3R\tuser %3U\tsys %3S\tpcpu %P\n&#39;</span>
<span class="nb">export </span><span class="nv">HISTIGNORE</span><span class="o">=</span><span class="s2">&quot;&amp;:bg:fg:ll:h&quot;</span>
<span class="nb">export </span><span class="nv">HISTTIMEFORMAT</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span> -e <span class="si">${</span><span class="nv">BCyan</span><span class="si">}</span><span class="k">)</span><span class="s2">[%d/%m %H:%M:%S]</span><span class="k">$(</span><span class="nb">echo</span> -e <span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="k">)</span><span class="s2"> &quot;</span>
<span class="nb">export </span><span class="nv">HISTCONTROL</span><span class="o">=</span>ignoredups
<span class="nb">export </span><span class="nv">HOSTFILE</span><span class="o">=</span><span class="nv">$HOME</span>/.hosts    <span class="c"># Put a list of remote hosts in ~/.hosts</span>


<span class="c">#============================================================</span>
<span class="c">#</span>
<span class="c">#  ALIASES AND FUNCTIONS</span>
<span class="c">#</span>
<span class="c">#  Arguably, some functions defined here are quite big.</span>
<span class="c">#  If you want to make this file smaller, these functions can</span>
<span class="c">#+ be converted into scripts and removed from here.</span>
<span class="c">#</span>
<span class="c">#============================================================</span>

<span class="c">#-------------------</span>
<span class="c"># Personnal Aliases</span>
<span class="c">#-------------------</span>

<span class="nb">alias </span><span class="nv">rm</span><span class="o">=</span><span class="s1">&#39;rm -i&#39;</span>
<span class="nb">alias </span><span class="nv">cp</span><span class="o">=</span><span class="s1">&#39;cp -i&#39;</span>
<span class="nb">alias </span><span class="nv">mv</span><span class="o">=</span><span class="s1">&#39;mv -i&#39;</span>
<span class="c"># -&gt; Prevents accidentally clobbering files.</span>
<span class="nb">alias </span><span class="nv">mkdir</span><span class="o">=</span><span class="s1">&#39;mkdir -p&#39;</span>

<span class="nb">alias </span><span class="nv">h</span><span class="o">=</span><span class="s1">&#39;history&#39;</span>
<span class="nb">alias </span><span class="nv">j</span><span class="o">=</span><span class="s1">&#39;jobs -l&#39;</span>
<span class="nb">alias </span><span class="nv">which</span><span class="o">=</span><span class="s1">&#39;type -a&#39;</span>
<span class="nb">alias</span> ..<span class="o">=</span><span class="s1">&#39;cd ..&#39;</span>

<span class="c"># Pretty-print of some PATH variables:</span>
<span class="nb">alias </span><span class="nv">path</span><span class="o">=</span><span class="s1">&#39;echo -e ${PATH//:/\\n}&#39;</span>
<span class="nb">alias </span><span class="nv">libpath</span><span class="o">=</span><span class="s1">&#39;echo -e ${LD_LIBRARY_PATH//:/\\n}&#39;</span>


<span class="nb">alias </span><span class="nv">du</span><span class="o">=</span><span class="s1">&#39;du -kh&#39;</span>    <span class="c"># Makes a more readable output.</span>
<span class="nb">alias </span><span class="nv">df</span><span class="o">=</span><span class="s1">&#39;df -kTh&#39;</span>

<span class="c">#-------------------------------------------------------------</span>
<span class="c"># The &#39;ls&#39; family (this assumes you use a recent GNU ls).</span>
<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Add colors for filetype and  human-readable sizes by default on &#39;ls&#39;:</span>
<span class="nb">alias </span><span class="nv">ls</span><span class="o">=</span><span class="s1">&#39;ls -h --color&#39;</span>
<span class="nb">alias </span><span class="nv">lx</span><span class="o">=</span><span class="s1">&#39;ls -lXB&#39;</span>         <span class="c">#  Sort by extension.</span>
<span class="nb">alias </span><span class="nv">lk</span><span class="o">=</span><span class="s1">&#39;ls -lSr&#39;</span>         <span class="c">#  Sort by size, biggest last.</span>
<span class="nb">alias </span><span class="nv">lt</span><span class="o">=</span><span class="s1">&#39;ls -ltr&#39;</span>         <span class="c">#  Sort by date, most recent last.</span>
<span class="nb">alias </span><span class="nv">lc</span><span class="o">=</span><span class="s1">&#39;ls -ltcr&#39;</span>        <span class="c">#  Sort by/show change time,most recent last.</span>
<span class="nb">alias </span><span class="nv">lu</span><span class="o">=</span><span class="s1">&#39;ls -ltur&#39;</span>        <span class="c">#  Sort by/show access time,most recent last.</span>

<span class="c"># The ubiquitous &#39;ll&#39;: directories first, with alphanumeric sorting:</span>
<span class="nb">alias </span><span class="nv">ll</span><span class="o">=</span><span class="s2">&quot;ls -lv --group-directories-first&quot;</span>
<span class="nb">alias </span><span class="nv">lm</span><span class="o">=</span><span class="s1">&#39;ll |more&#39;</span>        <span class="c">#  Pipe through &#39;more&#39;</span>
<span class="nb">alias </span><span class="nv">lr</span><span class="o">=</span><span class="s1">&#39;ll -R&#39;</span>           <span class="c">#  Recursive ls.</span>
<span class="nb">alias </span><span class="nv">la</span><span class="o">=</span><span class="s1">&#39;ll -A&#39;</span>           <span class="c">#  Show hidden files.</span>
<span class="nb">alias </span><span class="nv">tree</span><span class="o">=</span><span class="s1">&#39;tree -Csuh&#39;</span>    <span class="c">#  Nice alternative to &#39;recursive ls&#39; ...</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Tailoring &#39;less&#39;</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="nb">alias </span><span class="nv">more</span><span class="o">=</span><span class="s1">&#39;less&#39;</span>
<span class="nb">export </span><span class="nv">PAGER</span><span class="o">=</span>less
<span class="nb">export </span><span class="nv">LESSCHARSET</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span>
<span class="nb">export </span><span class="nv">LESSOPEN</span><span class="o">=</span><span class="s1">&#39;|/usr/bin/lesspipe.sh %s 2&gt;&amp;-&#39;</span>
                <span class="c"># Use this if lesspipe.sh exists.</span>
<span class="nb">export </span><span class="nv">LESS</span><span class="o">=</span><span class="s1">&#39;-i -N -w  -z-4 -g -e -M -X -F -R -P%t?f%f \</span>
<span class="s1">:stdin .?pb%pb\%:?lbLine %lb:?bbByte %bb:-...&#39;</span>

<span class="c"># LESS man page colors (makes Man pages more readable).</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_mb</span><span class="o">=</span><span class="s1">$&#39;\E[01;31m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_md</span><span class="o">=</span><span class="s1">$&#39;\E[01;31m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_me</span><span class="o">=</span><span class="s1">$&#39;\E[0m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_se</span><span class="o">=</span><span class="s1">$&#39;\E[0m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_so</span><span class="o">=</span><span class="s1">$&#39;\E[01;44;33m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_ue</span><span class="o">=</span><span class="s1">$&#39;\E[0m&#39;</span>
<span class="nb">export </span><span class="nv">LESS_TERMCAP_us</span><span class="o">=</span><span class="s1">$&#39;\E[01;32m&#39;</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Spelling typos - highly personnal and keyboard-dependent :-)</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="nb">alias </span><span class="nv">xs</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span>
<span class="nb">alias </span><span class="nv">vf</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span>
<span class="nb">alias </span><span class="nv">moer</span><span class="o">=</span><span class="s1">&#39;more&#39;</span>
<span class="nb">alias </span><span class="nv">moew</span><span class="o">=</span><span class="s1">&#39;more&#39;</span>
<span class="nb">alias </span><span class="nv">kk</span><span class="o">=</span><span class="s1">&#39;ll&#39;</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># A few fun ones</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="c"># Adds some text in the terminal frame (if applicable).</span>

<span class="k">function</span> xtitle<span class="o">()</span>
<span class="o">{</span>
    <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$TERM</span><span class="s2">&quot;</span> in
    *term*rxvt<span class="o">)</span>
        <span class="nb">echo</span> -en  <span class="s2">&quot;\e]0;</span><span class="nv">$*</span><span class="s2">\a&quot;</span> <span class="p">;;</span>
    *<span class="o">)</span>  <span class="p">;;</span>
    <span class="k">esac</span>
<span class="o">}</span>


<span class="c"># Aliases that use xtitle</span>
<span class="nb">alias </span><span class="nv">top</span><span class="o">=</span><span class="s1">&#39;xtitle Processes on $HOST &amp;&amp; top&#39;</span>
<span class="nb">alias </span><span class="nv">make</span><span class="o">=</span><span class="s1">&#39;xtitle Making $(basename $PWD) ; make&#39;</span>

<span class="c"># .. and functions</span>
<span class="k">function</span> man<span class="o">()</span>
<span class="o">{</span>
    <span class="k">for</span> i <span class="p">;</span> <span class="k">do</span>
        xtitle The <span class="k">$(</span>basename <span class="nv">$1</span><span class="p">|</span>tr -d .<span class="o">[</span>:digit:<span class="o">]</span><span class="k">)</span> manual
        <span class="nb">command </span>man -a <span class="s2">&quot;</span><span class="nv">$i</span><span class="s2">&quot;</span>
    <span class="k">done</span>
<span class="o">}</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># Make the following commands run in background automatically:</span>
<span class="c">#-------------------------------------------------------------</span>

<span class="k">function</span> te<span class="o">()</span>  <span class="c"># wrapper around xemacs/gnuserv</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="k">$(</span>gnuclient -batch -eval t 2&gt;<span class="p">&amp;</span>-<span class="k">)</span><span class="s2">&quot;</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
       gnuclient -q <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="k">else</span>
       <span class="o">(</span> xemacs <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">&amp;</span><span class="o">)</span><span class="p">;</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="k">function</span> soffice<span class="o">()</span> <span class="o">{</span> <span class="nb">command </span>soffice <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">&amp;</span> <span class="o">}</span>
<span class="k">function</span> firefox<span class="o">()</span> <span class="o">{</span> <span class="nb">command </span>firefox <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">&amp;</span> <span class="o">}</span>
<span class="k">function</span> xpdf<span class="o">()</span> <span class="o">{</span> <span class="nb">command </span>xpdf <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span> <span class="p">&amp;</span> <span class="o">}</span>


<span class="c">#-------------------------------------------------------------</span>
<span class="c"># File &amp; strings related functions:</span>
<span class="c">#-------------------------------------------------------------</span>


<span class="c"># Find a file with a pattern in name:</span>
<span class="k">function</span> ff<span class="o">()</span> <span class="o">{</span> find . -type f -iname <span class="s1">&#39;*&#39;</span><span class="s2">&quot;</span><span class="nv">$*</span><span class="s2">&quot;</span><span class="s1">&#39;*&#39;</span> -ls <span class="p">;</span> <span class="o">}</span>

<span class="c"># Find a file with pattern $1 in name and Execute $2 on it:</span>
<span class="k">function</span> fe<span class="o">()</span> <span class="o">{</span> find . -type f -iname <span class="s1">&#39;*&#39;</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="si">}</span><span class="s2">&quot;</span><span class="s1">&#39;*&#39;</span> <span class="se">\</span>
-exec <span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="nv">file</span><span class="si">}</span> <span class="o">{}</span> <span class="se">\;</span>  <span class="p">;</span> <span class="o">}</span>

<span class="c">#  Find a pattern in a set of files and highlight them:</span>
<span class="c">#+ (needs a recent version of egrep).</span>
<span class="k">function</span> fstr<span class="o">()</span>
<span class="o">{</span>
    <span class="nv">OPTIND</span><span class="o">=</span>1
    <span class="nb">local </span><span class="nv">mycase</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="nb">local </span><span class="nv">usage</span><span class="o">=</span><span class="s2">&quot;fstr: find string in files.</span>
<span class="s2">Usage: fstr [-i] \&quot;pattern\&quot; [\&quot;filename pattern\&quot;] &quot;</span>
    <span class="k">while</span> <span class="nb">getopts</span> :it opt
    <span class="k">do</span>
        <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$opt</span><span class="s2">&quot;</span> in
           i<span class="o">)</span> <span class="nv">mycase</span><span class="o">=</span><span class="s2">&quot;-i &quot;</span> <span class="p">;;</span>
           *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$usage</span><span class="s2">&quot;</span><span class="p">;</span> <span class="k">return</span> <span class="p">;;</span>
        <span class="k">esac</span>
    <span class="k">done</span>
    <span class="nb">shift</span> <span class="k">$((</span> <span class="nv">$OPTIND</span> <span class="o">-</span> <span class="m">1</span> <span class="k">))</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$#&quot;</span><span class="s2"> -lt 1 ]; then</span>
<span class="s2">        echo &quot;</span><span class="nv">$usage</span><span class="s2">&quot;</span>
<span class="s2">        return;</span>
<span class="s2">    fi</span>
<span class="s2">    find . -type f -name &quot;</span><span class="si">${</span><span class="nv">2</span><span class="k">:-</span><span class="p">*</span><span class="si">}</span><span class="s2">&quot; -print0\</span>
<span class="s2">xargs -0 egrep --color=always -sn </span><span class="si">${</span><span class="nv">case</span><span class="si">}</span><span class="s2"> &quot;</span><span class="nv">$1</span><span class="s2">&quot; 2&gt;&amp;-more</span>

<span class="s2">}</span>


<span class="s2">function swap()</span>
<span class="s2">{ # Swap 2 filenames around, if they exist (from Uzi&#39;s bashrc).</span>
<span class="s2">    local TMPFILE=tmp.</span><span class="nv">$$</span><span class="s2"></span>

<span class="s2">    [ </span><span class="nv">$# </span><span class="s2">-ne 2 ] &amp;&amp; echo &quot;</span>swap: <span class="m">2</span> arguments needed<span class="s2">&quot; &amp;&amp; return 1</span>
<span class="s2">    [ ! -e </span><span class="nv">$1</span><span class="s2"> ] &amp;&amp; echo &quot;</span>swap: <span class="nv">$1</span> does not exist<span class="s2">&quot; &amp;&amp; return 1</span>
<span class="s2">    [ ! -e </span><span class="nv">$2</span><span class="s2"> ] &amp;&amp; echo &quot;</span>swap: <span class="nv">$2</span> does not exist<span class="s2">&quot; &amp;&amp; return 1</span>

<span class="s2">    mv &quot;</span><span class="nv">$1</span><span class="s2">&quot; </span><span class="nv">$TMPFILE</span><span class="s2"></span>
<span class="s2">    mv &quot;</span><span class="nv">$2</span><span class="s2">&quot; &quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="s2">    mv </span><span class="nv">$TMPFILE</span><span class="s2"> &quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="s2">}</span>

<span class="s2">function extract()      # Handy Extract Program</span>
<span class="s2">{</span>
<span class="s2">    if [ -f </span><span class="nv">$1</span><span class="s2"> ] ; then</span>
<span class="s2">        case </span><span class="nv">$1</span><span class="s2"> in</span>
<span class="s2">            *.tar.bz2)   tar xvjf </span><span class="nv">$1</span><span class="s2">     ;;</span>
<span class="s2">            *.tar.gz)    tar xvzf </span><span class="nv">$1</span><span class="s2">     ;;</span>
<span class="s2">            *.bz2)       bunzip2 </span><span class="nv">$1</span><span class="s2">      ;;</span>
<span class="s2">            *.rar)       unrar x </span><span class="nv">$1</span><span class="s2">      ;;</span>
<span class="s2">            *.gz)        gunzip </span><span class="nv">$1</span><span class="s2">       ;;</span>
<span class="s2">            *.tar)       tar xvf </span><span class="nv">$1</span><span class="s2">      ;;</span>
<span class="s2">            *.tbz2)      tar xvjf </span><span class="nv">$1</span><span class="s2">     ;;</span>
<span class="s2">            *.tgz)       tar xvzf </span><span class="nv">$1</span><span class="s2">     ;;</span>
<span class="s2">            *.zip)       unzip </span><span class="nv">$1</span><span class="s2">        ;;</span>
<span class="s2">            *.Z)         uncompress </span><span class="nv">$1</span><span class="s2">   ;;</span>
<span class="s2">            *.7z)        7z x </span><span class="nv">$1</span><span class="s2">         ;;</span>
<span class="s2">            *)           echo &quot;</span><span class="s1">&#39;$1&#39;</span> cannot be extracted via &gt;extract&lt;<span class="s2">&quot; ;;</span>
<span class="s2">        esac</span>
<span class="s2">    else</span>
<span class="s2">        echo &quot;</span><span class="s1">&#39;$1&#39;</span> is not a valid file!<span class="s2">&quot;</span>
<span class="s2">    fi</span>
<span class="s2">}</span>


<span class="s2"># Creates an archive (*.tar.gz) from given directory.</span>
<span class="s2">function maketar() { tar cvzf &quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%%/</span><span class="si">}</span>.tar.gz<span class="s2">&quot;  &quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%%/</span><span class="si">}</span>/<span class="s2">&quot;; }</span>

<span class="s2"># Create a ZIP archive of a file or folder.</span>
<span class="s2">function makezip() { zip -r &quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%%/</span><span class="si">}</span>.zip<span class="s2">&quot; &quot;</span><span class="nv">$1</span><span class="s2">&quot; ; }</span>

<span class="s2"># Make your directories and files access rights sane.</span>
<span class="s2">function sanitize() { chmod -R u=rwX,g=rX,o= &quot;</span><span class="nv">$@</span><span class="s2">&quot; ;}</span>

<span class="s2">#-------------------------------------------------------------</span>
<span class="s2"># Process/system related functions:</span>
<span class="s2">#-------------------------------------------------------------</span>


<span class="s2">function my_ps() { ps </span><span class="nv">$@</span><span class="s2"> -u </span><span class="nv">$USER</span><span class="s2"> -o pid,%cpu,%mem,bsdtime,command ; }</span>
<span class="s2">function pp() { my_ps fawk &#39;!/awk/ &amp;&amp; </span><span class="nv">$0</span><span class="s2">~var&#39; var=</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="s2">&quot;.*&quot;</span><span class="si">}</span><span class="s2"> ; }</span>


<span class="s2">function killps()   # kill by process name</span>
<span class="s2">{</span>
<span class="s2">    local pid pname sig=&quot;</span>-TERM<span class="s2">&quot;   # default signal</span>
<span class="s2">    if [ &quot;</span><span class="nv">$#&quot;</span> -lt <span class="m">1</span> <span class="o">]</span> <span class="p">|</span><span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$#&quot;</span><span class="s2"> -gt 2 ]; then</span>
<span class="s2">        echo &quot;</span>Usage: killps <span class="o">[</span>-SIGNAL<span class="o">]</span> pattern<span class="s2">&quot;</span>
<span class="s2">        return;</span>
<span class="s2">    fi</span>
<span class="s2">    if [ </span><span class="nv">$# </span><span class="s2">= 2 ]; then sig=</span><span class="nv">$1</span><span class="s2"> ; fi</span>
<span class="s2">    for pid in </span><span class="k">$(</span>my_psawk <span class="s1">&#39;!/awk/ &amp;&amp; $0~pat { print $1 }&#39;</span> <span class="nv">pat</span><span class="o">=</span><span class="si">${</span><span class="p">!#</span><span class="si">}</span> <span class="k">)</span><span class="s2"></span>
<span class="s2">    do</span>
<span class="s2">        pname=</span><span class="k">$(</span>my_psawk <span class="s1">&#39;$1~var { print $5 }&#39;</span> <span class="nv">var</span><span class="o">=</span><span class="nv">$pid</span> <span class="k">)</span><span class="s2"></span>
<span class="s2">        if ask &quot;</span>Kill process <span class="nv">$pid</span> &lt;<span class="nv">$pname</span>&gt; with signal <span class="nv">$sig</span>?<span class="s2">&quot;</span>
<span class="s2">            then kill </span><span class="nv">$sig</span><span class="s2"> </span><span class="nv">$pid</span><span class="s2"></span>
<span class="s2">        fi</span>
<span class="s2">    done</span>
<span class="s2">}</span>

<span class="s2">function mydf()         # Pretty-print of &#39;df&#39; output.</span>
<span class="s2">{                       # Inspired by &#39;dfc&#39; utility.</span>
<span class="s2">    for fs ; do</span>

<span class="s2">        if [ ! -d </span><span class="nv">$fs</span><span class="s2"> ]</span>
<span class="s2">        then</span>
<span class="s2">          echo -e </span><span class="nv">$fs</span><span class="s2">&quot;</span> :No such file or directory<span class="s2">&quot; ; continue</span>
<span class="s2">        fi</span>

<span class="s2">        local info=( </span><span class="k">$(</span><span class="nb">command </span>df -P <span class="nv">$fsawk</span> <span class="s1">&#39;END{ print $2,$3,$5 }&#39;</span><span class="k">)</span><span class="s2"> )</span>
<span class="s2">        local free=( </span><span class="k">$(</span><span class="nb">command </span>df -Pkh <span class="nv">$fsawk</span> <span class="s1">&#39;END{ print $4 }&#39;</span><span class="k">)</span><span class="s2"> )</span>
<span class="s2">        local nbstars=</span><span class="k">$((</span> <span class="m">20</span> <span class="o">*</span> <span class="si">${</span><span class="nv">info</span><span class="p">[1]</span><span class="si">}</span> <span class="o">/</span> <span class="si">${</span><span class="nv">info</span><span class="p">[0]</span><span class="si">}</span> <span class="k">))</span><span class="s2"></span>
<span class="s2">        local out=&quot;</span><span class="o">[</span><span class="s2">&quot;</span>
<span class="s2">        for ((j=0;j&lt;20;j++)); do</span>
<span class="s2">            if [ </span><span class="si">${</span><span class="nv">j</span><span class="si">}</span><span class="s2"> -lt </span><span class="si">${</span><span class="nv">nbstars</span><span class="si">}</span><span class="s2"> ]; then</span>
<span class="s2">               out=</span><span class="nv">$out</span><span class="s2">&quot;</span>*<span class="s2">&quot;</span>
<span class="s2">            else</span>
<span class="s2">               out=</span><span class="nv">$out</span><span class="s2">&quot;</span>-<span class="s2">&quot;</span>
<span class="s2">            fi</span>
<span class="s2">        done</span>
<span class="s2">        out=</span><span class="si">${</span><span class="nv">info</span><span class="p">[2]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$out</span><span class="s2">&quot;</span><span class="o">]</span> <span class="o">(</span><span class="s2">&quot;</span><span class="nv">$free</span><span class="s2">&quot;</span> free on <span class="s2">&quot;</span><span class="nv">$fs</span><span class="s2">&quot;</span><span class="o">)</span><span class="s2">&quot;</span>
<span class="s2">        echo -e </span><span class="nv">$out</span><span class="s2"></span>
<span class="s2">    done</span>
<span class="s2">}</span>


<span class="s2">function my_ip() # Get IP adress on ethernet.</span>
<span class="s2">{</span>
<span class="s2">    MY_IP=</span><span class="k">$(</span>/sbin/ifconfig eth0awk <span class="s1">&#39;/inet/ { print $2 } &#39;</span>
      sed -e s/addr://<span class="k">)</span><span class="s2"></span>
<span class="s2">    echo </span><span class="si">${</span><span class="nv">MY_IP</span><span class="k">:-</span><span class="s2">&quot;Not connected&quot;</span><span class="si">}</span><span class="s2"></span>
<span class="s2">}</span>

<span class="s2">function ii()   # Get current host related info.</span>
<span class="s2">{</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span>You are logged on <span class="si">${</span><span class="nv">BRed</span><span class="si">}</span><span class="nv">$HOST</span><span class="s2">&quot;</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Additionnal information:<span class="nv">$NC</span> <span class="s2">&quot; ; uname -a</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Users logged on:<span class="nv">$NC</span> <span class="s2">&quot; ; w -hs</span>
<span class="s2">             cut -d &quot;</span> <span class="s2">&quot; -f1sort | uniq</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Current date :<span class="nv">$NC</span> <span class="s2">&quot; ; date</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Machine stats :<span class="nv">$NC</span> <span class="s2">&quot; ; uptime</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Memory stats :<span class="nv">$NC</span> <span class="s2">&quot; ; free</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Diskspace :<span class="nv">$NC</span> <span class="s2">&quot; ; mydf / </span><span class="nv">$HOME</span><span class="s2"></span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Local IP Address :<span class="nv">$NC</span><span class="s2">&quot; ; my_ip</span>
<span class="s2">    echo -e &quot;</span><span class="se">\n</span><span class="si">${</span><span class="nv">BRed</span><span class="si">}</span>Open connections :<span class="nv">$NC</span> <span class="s2">&quot;; netstat -pan --inet;</span>
<span class="s2">    echo</span>
<span class="s2">}</span>

<span class="s2">#-------------------------------------------------------------</span>
<span class="s2"># Misc utilities:</span>
<span class="s2">#-------------------------------------------------------------</span>

<span class="s2">function repeat()       # Repeat n times command.</span>
<span class="s2">{</span>
<span class="s2">    local i max</span>
<span class="s2">    max=</span><span class="nv">$1</span><span class="s2">; shift;</span>
<span class="s2">    for ((i=1; i &lt;= max ; i++)); do  # --&gt; C-like syntax</span>
<span class="s2">        eval &quot;</span><span class="nv">$@</span><span class="s2">&quot;;</span>
<span class="s2">    done</span>
<span class="s2">}</span>


<span class="s2">function ask()          # See &#39;killps&#39; for example of use.</span>
<span class="s2">{</span>
<span class="s2">    echo -n &quot;</span><span class="nv">$@</span><span class="s2">&quot; &#39;[y/n] &#39; ; read ans</span>
<span class="s2">    case &quot;</span><span class="nv">$ans</span><span class="s2">&quot; in</span>
<span class="s2">        y*|Y*) return 0 ;;</span>
<span class="s2">        *) return 1 ;;</span>
<span class="s2">    esac</span>
<span class="s2">}</span>

<span class="s2">function corename()   # Get name of app that created a corefile.</span>
<span class="s2">{</span>
<span class="s2">    for file ; do</span>
<span class="s2">        echo -n </span><span class="nv">$file</span><span class="s2"> : ; gdb --core=</span><span class="nv">$file</span><span class="s2"> --batchhead -1</span>
<span class="s2">    done</span>
<span class="s2">}</span>



<span class="s2">#=========================================================================</span>
<span class="s2">#</span>
<span class="s2">#  PROGRAMMABLE COMPLETION SECTION</span>
<span class="s2">#  Most are taken from the bash 2.05 documentation and from Ian McDonald&#39;s</span>
<span class="s2"># &#39;Bash completion&#39; package (http://www.caliban.org/bash/#completion)</span>
<span class="s2">#  You will in fact need bash more recent then 3.0 for some features.</span>
<span class="s2">#</span>
<span class="s2">#  Note that most linux distributions now provide many completions</span>
<span class="s2"># &#39;out of the box&#39; - however, you might need to make your own one day,</span>
<span class="s2">#  so I kept those here as examples.</span>
<span class="s2">#=========================================================================</span>

<span class="s2">if [ &quot;</span><span class="si">${</span><span class="nv">BASH_VERSION</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot; \&lt; &quot;</span>3.0<span class="s2">&quot; ]; then</span>
<span class="s2">    echo &quot;</span>You will need to upgrade to version 3.0 <span class="k">for</span> full <span class="se">\</span>
          programmable completion features<span class="s2">&quot;</span>
<span class="s2">    return</span>
<span class="s2">fi</span>

<span class="s2">shopt -s extglob        # Necessary.</span>

<span class="s2">complete -A hostname   rsh rcp telnet rlogin ftp ping disk</span>
<span class="s2">complete -A export     printenv</span>
<span class="s2">complete -A variable   export local readonly unset</span>
<span class="s2">complete -A enabled    builtin</span>
<span class="s2">complete -A alias      alias unalias</span>
<span class="s2">complete -A function   function</span>
<span class="s2">complete -A user       su mail finger</span>

<span class="s2">complete -A helptopic  help     # Currently same as builtins.</span>
<span class="s2">complete -A shopt      shopt</span>
<span class="s2">complete -A stopped -P &#39;%&#39; bg</span>
<span class="s2">complete -A job -P &#39;%&#39;     fg jobs disown</span>

<span class="s2">complete -A directory  mkdir rmdir</span>
<span class="s2">complete -A directory   -o default cd</span>

<span class="s2"># Compression</span>
<span class="s2">complete -f -o default -X &#39;*.+(zip|ZIP)&#39;  zip</span>
<span class="s2">complete -f -o default -X &#39;!*.+(zip|ZIP)&#39; unzip</span>
<span class="s2">complete -f -o default -X &#39;*.+(z|Z)&#39;      compress</span>
<span class="s2">complete -f -o default -X &#39;!*.+(z|Z)&#39;     uncompress</span>
<span class="s2">complete -f -o default -X &#39;*.+(gz|GZ)&#39;    gzip</span>
<span class="s2">complete -f -o default -X &#39;!*.+(gz|GZ)&#39;   gunzip</span>
<span class="s2">complete -f -o default -X &#39;*.+(bz2|BZ2)&#39;  bzip2</span>
<span class="s2">complete -f -o default -X &#39;!*.+(bz2|BZ2)&#39; bunzip2</span>
<span class="s2">complete -f -o default -X &#39;!*.+(zip|ZIP|z|Z|gz|GZ|bz2|BZ2)&#39; extract</span>


<span class="s2"># Documents - Postscript,pdf,dvi.....</span>
<span class="s2">complete -f -o default -X &#39;!*.+(ps|PS)&#39;  gs ghostview ps2pdf ps2ascii</span>
<span class="s2">complete -f -o default -X \</span>
<span class="s2">&#39;!*.+(dvi|DVI)&#39; dvips dvipdf xdvi dviselect dvitype</span>
<span class="s2">complete -f -o default -X &#39;!*.+(pdf|PDF)&#39; acroread pdf2ps</span>
<span class="s2">complete -f -o default -X &#39;!*.@(@(?(e)ps|?(E)PS|pdf|PDF)?\</span>
<span class="s2">(.gz|.GZ|.bz2|.BZ2|.Z))&#39; gv ggv</span>
<span class="s2">complete -f -o default -X &#39;!*.texi*&#39; makeinfo texi2dvi texi2html texi2pdf</span>
<span class="s2">complete -f -o default -X &#39;!*.tex&#39; tex latex slitex</span>
<span class="s2">complete -f -o default -X &#39;!*.lyx&#39; lyx</span>
<span class="s2">complete -f -o default -X &#39;!*.+(htm*|HTM*)&#39; lynx html2ps</span>
<span class="s2">complete -f -o default -X \</span>
<span class="s2">&#39;!*.+(doc|DOC|xls|XLS|ppt|PPT|sx?|SX?|csv|CSV|od?|OD?|ott|OTT)&#39; soffice</span>

<span class="s2"># Multimedia</span>
<span class="s2">complete -f -o default -X \</span>
<span class="s2">&#39;!*.+(gif|GIF|jp*g|JP*G|bmp|BMP|xpm|XPM|png|PNG)&#39; xv gimp ee gqview</span>
<span class="s2">complete -f -o default -X &#39;!*.+(mp3|MP3)&#39; mpg123 mpg321</span>
<span class="s2">complete -f -o default -X &#39;!*.+(ogg|OGG)&#39; ogg123</span>
<span class="s2">complete -f -o default -X \</span>
<span class="s2">&#39;!*.@(mp[23]|MP[23]|ogg|OGG|wav|WAV|pls|\</span>
<span class="s2">m3u|xm|mod|s[3t]m|it|mtm|ult|flac)&#39; xmms</span>
<span class="s2">complete -f -o default -X &#39;!*.@(mp?(e)g|MP?(E)G|wma|avi|AVI|\</span>
<span class="s2">asf|vob|VOB|bin|dat|vcd|ps|pes|fli|viv|rm|ram|yuv|mov|MOV|qt|\</span>
<span class="s2">QT|wmv|mp3|MP3|ogg|OGG|ogm|OGM|mp4|MP4|wav|WAV|asx|ASX)&#39; xine</span>



<span class="s2">complete -f -o default -X &#39;!*.pl&#39;  perl perl5</span>


<span class="s2">#  This is a &#39;universal&#39; completion function - it works when commands have</span>
<span class="s2">#+ a so-called &#39;long options&#39; mode , ie: &#39;ls --all&#39; instead of &#39;ls -a&#39;</span>
<span class="s2">#  Needs the &#39;-o&#39; option of grep</span>
<span class="s2">#+ (try the commented-out version if not available).</span>

<span class="s2">#  First, remove &#39;=&#39; from completion word separators</span>
<span class="s2">#+ (this will allow completions like &#39;ls --color=auto&#39; to work correctly).</span>

<span class="s2">COMP_WORDBREAKS=</span><span class="si">${</span><span class="nv">COMP_WORDBREAKS</span><span class="p">/=/</span><span class="si">}</span><span class="s2"></span>


<span class="s2">_get_longopts()</span>
<span class="s2">{</span>
<span class="s2">  #</span><span class="nv">$1</span><span class="s2"> --helpsed  -e &#39;/--/!d&#39; -e &#39;s/.*--\([^[:space:].,]*\).*/--\1/&#39;| \</span>
<span class="s2">  #grep ^&quot;</span><span class="nv">$2</span><span class="s2">&quot; |sort -u ;</span>
<span class="s2">    </span><span class="nv">$1</span><span class="s2"> --helpgrep -o -e &quot;</span>--<span class="o">[</span>^<span class="o">[</span>:space:<span class="o">]</span>.,<span class="o">]</span>*<span class="s2">&quot; | grep -e &quot;</span><span class="nv">$2</span><span class="s2">&quot; |sort -u</span>
<span class="s2">}</span>

<span class="s2">_longopts()</span>
<span class="s2">{</span>
<span class="s2">    local cur</span>
<span class="s2">    cur=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[COMP_CWORD]</span><span class="si">}</span><span class="s2"></span>

<span class="s2">    case &quot;</span><span class="si">${</span><span class="nv">cur</span><span class="k">:-</span><span class="p">*</span><span class="si">}</span><span class="s2">&quot; in</span>
<span class="s2">       -*)      ;;</span>
<span class="s2">        *)      return ;;</span>
<span class="s2">    esac</span>

<span class="s2">    case &quot;</span><span class="nv">$1</span><span class="s2">&quot; in</span>
<span class="s2">       \~*)     eval cmd=&quot;</span><span class="nv">$1</span><span class="s2">&quot; ;;</span>
<span class="s2">         *)     cmd=&quot;</span><span class="nv">$1</span><span class="s2">&quot; ;;</span>
<span class="s2">    esac</span>
<span class="s2">    COMPREPLY=( </span><span class="k">$(</span>_get_longopts <span class="si">${</span><span class="nv">1</span><span class="si">}</span> <span class="si">${</span><span class="nv">cur</span><span class="si">}</span> <span class="k">)</span><span class="s2"> )</span>
<span class="s2">}</span>
<span class="s2">complete  -o default -F _longopts configure bash</span>
<span class="s2">complete  -o default -F _longopts wget id info a2ps ls recode</span>

<span class="s2">_tar()</span>
<span class="s2">{</span>
<span class="s2">    local cur ext regex tar untar</span>

<span class="s2">    COMPREPLY=()</span>
<span class="s2">    cur=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[COMP_CWORD]</span><span class="si">}</span><span class="s2"></span>

<span class="s2">    # If we want an option, return the possible long options.</span>
<span class="s2">    case &quot;</span><span class="nv">$cur</span><span class="s2">&quot; in</span>
<span class="s2">        -*)     COMPREPLY=( </span><span class="k">$(</span>_get_longopts <span class="nv">$1</span> <span class="nv">$cur</span> <span class="k">)</span><span class="s2"> ); return 0;;</span>
<span class="s2">    esac</span>

<span class="s2">    if [ </span><span class="nv">$COMP_CWORD</span><span class="s2"> -eq 1 ]; then</span>
<span class="s2">        COMPREPLY=( </span><span class="k">$(</span> <span class="nb">compgen</span> -W <span class="s1">&#39;c t x u r d A&#39;</span> -- <span class="nv">$cur</span> <span class="k">)</span><span class="s2"> )</span>
<span class="s2">        return 0</span>
<span class="s2">    fi</span>

<span class="s2">    case &quot;</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot; in</span>
<span class="s2">        ?(-)c*f)</span>
<span class="s2">            COMPREPLY=( </span><span class="k">$(</span> <span class="nb">compgen</span> -f <span class="nv">$cur</span> <span class="k">)</span><span class="s2"> )</span>
<span class="s2">            return 0</span>
<span class="s2">            ;;</span>
<span class="s2">        +([^Izjy])f)</span>
<span class="s2">            ext=&#39;tar&#39;</span>
<span class="s2">            regex=</span><span class="nv">$ext</span><span class="s2"></span>
<span class="s2">            ;;</span>
<span class="s2">        *z*f)</span>
<span class="s2">            ext=&#39;tar.gz&#39;</span>
<span class="s2">            regex=&#39;t\(ar\.\)\(gz\|Z\)&#39;</span>
<span class="s2">            ;;</span>
<span class="s2">        *[Ijy]*f)</span>
<span class="s2">            ext=&#39;t?(ar.)bz?(2)&#39;</span>
<span class="s2">            regex=&#39;t\(ar\.\)bz2\?&#39;</span>
<span class="s2">            ;;</span>
<span class="s2">        *)</span>
<span class="s2">            COMPREPLY=( </span><span class="k">$(</span> <span class="nb">compgen</span> -f <span class="nv">$cur</span> <span class="k">)</span><span class="s2"> )</span>
<span class="s2">            return 0</span>
<span class="s2">            ;;</span>

<span class="s2">    esac</span>

<span class="s2">    if [[ &quot;</span><span class="nv">$COMP_LINE</span><span class="s2">&quot; == tar*.</span><span class="nv">$ext</span><span class="s2">&#39; &#39;* ]]; then</span>
<span class="s2">        # Complete on files in tar file.</span>
<span class="s2">        #</span>
<span class="s2">        # Get name of tar file from command line.</span>
<span class="s2">        tar=</span><span class="k">$(</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$COMP_LINE</span><span class="s2">&quot;</span><span class="se">\</span>
                        sed -e <span class="s1">&#39;s|^.* \([^ ]*&#39;</span><span class="nv">$regex</span><span class="s1">&#39;\) .*$|\1|&#39;</span> <span class="k">)</span><span class="s2"></span>
<span class="s2">        # Devise how to untar and list it.</span>
<span class="s2">        untar=t</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[1]//[^Izjyf]/</span><span class="si">}</span><span class="s2"></span>

<span class="s2">        COMPREPLY=( </span><span class="k">$(</span> <span class="nb">compgen</span> -W <span class="s2">&quot;</span><span class="k">$(</span> <span class="nb">echo</span> <span class="k">$(</span> tar <span class="nv">$untar</span> <span class="nv">$tar</span> <span class="se">\</span>
                                2&gt;/dev/null <span class="k">)</span> <span class="k">)</span><span class="s2">&quot;</span> -- <span class="s2">&quot;</span><span class="nv">$cur</span><span class="s2">&quot;</span> <span class="k">)</span><span class="s2"> )</span>
<span class="s2">        return 0</span>

<span class="s2">    else</span>
<span class="s2">        # File completion on relevant files.</span>
<span class="s2">        COMPREPLY=( </span><span class="k">$(</span> <span class="nb">compgen</span> -G <span class="nv">$cur</span><span class="se">\*</span>.<span class="nv">$ext</span> <span class="k">)</span><span class="s2"> )</span>

<span class="s2">    fi</span>

<span class="s2">    return 0</span>

<span class="s2">}</span>

<span class="s2">complete -F _tar -o default tar</span>

<span class="s2">_make()</span>
<span class="s2">{</span>
<span class="s2">    local mdef makef makef_dir=&quot;</span>.<span class="s2">&quot; makef_inc gcmd cur prev i;</span>
<span class="s2">    COMPREPLY=();</span>
<span class="s2">    cur=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[COMP_CWORD]</span><span class="si">}</span><span class="s2">;</span>
<span class="s2">    prev=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[COMP_CWORD-1]</span><span class="si">}</span><span class="s2">;</span>
<span class="s2">    case &quot;</span><span class="nv">$prev</span><span class="s2">&quot; in</span>
<span class="s2">        -*f)</span>
<span class="s2">            COMPREPLY=(</span><span class="k">$(</span><span class="nb">compgen</span> -f <span class="nv">$cur</span> <span class="k">)</span><span class="s2">);</span>
<span class="s2">            return 0</span>
<span class="s2">            ;;</span>
<span class="s2">    esac;</span>
<span class="s2">    case &quot;</span><span class="nv">$cur</span><span class="s2">&quot; in</span>
<span class="s2">        -*)</span>
<span class="s2">            COMPREPLY=(</span><span class="k">$(</span>_get_longopts <span class="nv">$1</span> <span class="nv">$cur</span> <span class="k">)</span><span class="s2">);</span>
<span class="s2">            return 0</span>
<span class="s2">            ;;</span>
<span class="s2">    esac;</span>

<span class="s2">    # ... make reads</span>
<span class="s2">    #          GNUmakefile,</span>
<span class="s2">    #     then makefile</span>
<span class="s2">    #     then Makefile ...</span>
<span class="s2">    if [ -f </span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/GNUmakefile ]; then</span>
<span class="s2">        makef=</span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/GNUmakefile</span>
<span class="s2">    elif [ -f </span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/makefile ]; then</span>
<span class="s2">        makef=</span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/makefile</span>
<span class="s2">    elif [ -f </span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/Makefile ]; then</span>
<span class="s2">        makef=</span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/Makefile</span>
<span class="s2">    else</span>
<span class="s2">       makef=</span><span class="si">${</span><span class="nv">makef_dir</span><span class="si">}</span><span class="s2">/*.mk         # Local convention.</span>
<span class="s2">    fi</span>


<span class="s2">    #  Before we scan for targets, see if a Makefile name was</span>
<span class="s2">    #+ specified with -f.</span>
<span class="s2">    for (( i=0; i &lt; </span><span class="si">${#</span><span class="nv">COMP_WORDS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">; i++ )); do</span>
<span class="s2">        if [[ </span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[i]</span><span class="si">}</span><span class="s2"> == -f ]]; then</span>
<span class="s2">            # eval for tilde expansion</span>
<span class="s2">            eval makef=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[i+1]</span><span class="si">}</span><span class="s2"></span>
<span class="s2">            break</span>
<span class="s2">        fi</span>
<span class="s2">    done</span>
<span class="s2">    [ ! -f </span><span class="nv">$makef</span><span class="s2"> ] &amp;&amp; return 0</span>

<span class="s2">    # Deal with included Makefiles.</span>
<span class="s2">    makef_inc=</span><span class="k">$(</span> grep -E <span class="s1">&#39;^-?include&#39;</span> <span class="nv">$makef</span>
                 sed -e <span class="s2">&quot;s,^.* ,&quot;</span><span class="nv">$makef_dir</span><span class="s2">&quot;/,&quot;</span> <span class="k">)</span><span class="s2"></span>
<span class="s2">    for file in </span><span class="nv">$makef_inc</span><span class="s2">; do</span>
<span class="s2">        [ -f </span><span class="nv">$file</span><span class="s2"> ] &amp;&amp; makef=&quot;</span><span class="nv">$makef</span> <span class="nv">$file</span><span class="s2">&quot;</span>
<span class="s2">    done</span>


<span class="s2">    #  If we have a partial word to complete, restrict completions</span>
<span class="s2">    #+ to matches of that word.</span>
<span class="s2">    if [ -n &quot;</span><span class="nv">$cur</span><span class="s2">&quot; ]; then gcmd=&#39;grep &quot;</span>^<span class="nv">$cur</span><span class="s2">&quot;&#39; ; else gcmd=cat ; fi</span>

<span class="s2">    COMPREPLY=( </span><span class="k">$(</span> awk -F<span class="s1">&#39;:&#39;</span> <span class="s1">&#39;/^[a-zA-Z0-9][^$#\/\t=]*:([^=]|$)/ \</span>
<span class="s1">                               {split($1,A,/ /);for(i in A)print A[i]}&#39;</span> <span class="se">\</span>
                                <span class="nv">$makef</span> 2&gt;/dev/nulleval <span class="nv">$gcmd</span>  <span class="k">)</span><span class="s2">)</span>

<span class="s2">}</span>

<span class="s2">complete -F _make -X &#39;+(</span><span class="nv">$*</span><span class="s2">|*.[cho])&#39; make gmake pmake</span>




<span class="s2">_killall()</span>
<span class="s2">{</span>
<span class="s2">    local cur prev</span>
<span class="s2">    COMPREPLY=()</span>
<span class="s2">    cur=</span><span class="si">${</span><span class="nv">COMP_WORDS</span><span class="p">[COMP_CWORD]</span><span class="si">}</span><span class="s2"></span>

<span class="s2">    #  Get a list of processes</span>
<span class="s2">    #+ (the first sed evaluation</span>
<span class="s2">    #+ takes care of swapped out processes, the second</span>
<span class="s2">    #+ takes care of getting the basename of the process).</span>
<span class="s2">    COMPREPLY=( </span><span class="k">$(</span> ps -u <span class="nv">$USER</span> -o comm<span class="se">\</span>
        sed -e <span class="s1">&#39;1,1d&#39;</span> -e <span class="s1">&#39;s#[]\[]##g&#39;</span> -e <span class="s1">&#39;s#^.*/##&#39;</span><span class="se">\</span>
        awk <span class="s1">&#39;{if ($0 ~ /^&#39;</span><span class="nv">$cur</span><span class="s1">&#39;/) print $0}&#39;</span> <span class="k">)</span><span class="s2">)</span>

<span class="s2">    return 0</span>
<span class="s2">}</span>

<span class="s2">complete -F _killall killall killps</span>



<span class="s2"># Local Variables:</span>
<span class="s2"># mode:shell-script</span>
<span class="s2"># sh-shell:bash</span>
<span class="s2"># End:</span>
</pre></div>
</div>
<p>And, here is a snippet from Andrzej Szelachowski&#8217;s instructive
``      .bash_profile     `` file.</p>
</div>
<div class="section" id="exemple-2-bash-profile-file">
<h2>Exemple 2. ``        .bash_profile       `` file<a class="headerlink" href="#exemple-2-bash-profile-file" title="Link permanent a aquest títol">¶</a></h2>
<div class="highlight-sh"><div class="highlight"><pre><span class="c"># From Andrzej Szelachowski&#39;s ~/.bash_profile:</span>


<span class="c">#  Note that a variable may require special treatment</span>
<span class="c">#+ if it will be exported.</span>

<span class="nv">DARKGRAY</span><span class="o">=</span><span class="s1">&#39;\e[1;30m&#39;</span>
<span class="nv">LIGHTRED</span><span class="o">=</span><span class="s1">&#39;\e[1;31m&#39;</span>
<span class="nv">GREEN</span><span class="o">=</span><span class="s1">&#39;\e[32m&#39;</span>
<span class="nv">YELLOW</span><span class="o">=</span><span class="s1">&#39;\e[1;33m&#39;</span>
<span class="nv">LIGHTBLUE</span><span class="o">=</span><span class="s1">&#39;\e[1;34m&#39;</span>
<span class="nv">NC</span><span class="o">=</span><span class="s1">&#39;\e[m&#39;</span>

<span class="nv">PCT</span><span class="o">=</span><span class="s2">&quot;\`if [[ \$EUID -eq 0 ]]; then T=&#39;</span><span class="nv">$LIGHTRED</span><span class="s2">&#39; ; else T=&#39;</span><span class="nv">$LIGHTBLUE</span><span class="s2">&#39;; fi;</span>
<span class="s2">echo \$T \`&quot;</span>

<span class="c">#  For &quot;literal&quot; command substitution to be assigned to a variable,</span>
<span class="c">#+ use escapes and double quotes:</span>
<span class="c">#+       PCT=&quot;\` ... \`&quot; . . .</span>
<span class="c">#  Otherwise, the value of PCT variable is assigned only once,</span>
<span class="c">#+ when the variable is exported/read from .bash_profile,</span>
<span class="c">#+ and it will not change afterwards even if the user ID changes.</span>


<span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\n</span><span class="nv">$GREEN</span><span class="s2">[\w] \n</span><span class="nv">$DARKGRAY</span><span class="s2">(</span><span class="nv">$PCT</span><span class="s2">\t</span><span class="nv">$DARKGRAY</span><span class="s2">)-(</span><span class="nv">$PCT</span><span class="s2">\u</span><span class="nv">$DARKGRAY</span><span class="s2">)-(</span><span class="nv">$PCT</span><span class="s2">\!</span>
<span class="nv">$DARKGRAY</span><span class="s2">)</span><span class="nv">$YELLOW</span><span class="s2">-&gt; </span><span class="nv">$NC</span><span class="s2">&quot;</span>

<span class="c">#  Escape a variables whose value changes:</span>
<span class="c">#        if [[ \$EUID -eq 0 ]],</span>
<span class="c">#  Otherwise the value of the EUID variable will be assigned only once,</span>
<span class="c">#+ as above.</span>

<span class="c">#  When a variable is assigned, it should be called escaped:</span>
<span class="c">#+       echo \$T,</span>
<span class="c">#  Otherwise the value of the T variable is taken from the moment the PCT</span>
<span class="c">#+ variable is exported/read from .bash_profile.</span>
<span class="c">#  So, in this example it would be null.</span>

<span class="c">#  When a variable&#39;s value contains a semicolon it should be strong quoted:</span>
<span class="c">#        T=&#39;$LIGHTRED&#39;,</span>
<span class="c">#  Otherwise, the semicolon will be interpreted as a command separator.</span>


<span class="c">#  Variables PCT and PS1 can be merged into a new PS1 variable:</span>

<span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;\`if [[ \$EUID -eq 0 ]]; then PCT=&#39;</span><span class="nv">$LIGHTRED</span><span class="s2">&#39;;</span>
<span class="s2">else PCT=&#39;</span><span class="nv">$LIGHTBLUE</span><span class="s2">&#39;; fi;</span>
<span class="s2">echo &#39;\n</span><span class="nv">$GREEN</span><span class="s2">[\w] \n</span><span class="nv">$DARKGRAY</span><span class="s2">(&#39;\$PCT&#39;\t</span><span class="nv">$DARKGRAY</span><span class="s2">)-\</span>
<span class="s2">(&#39;\$PCT&#39;\u</span><span class="nv">$DARKGRAY</span><span class="s2">)-(&#39;\$PCT&#39;\!</span><span class="nv">$DARKGRAY</span><span class="s2">)</span><span class="nv">$YELLOW</span><span class="s2">-&gt; </span><span class="nv">$NC</span><span class="s2">&#39;\`&quot;</span>

<span class="c"># The trick is to use strong quoting for parts of old PS1 variable.</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  <hr/>

  

  <div role="contentinfo">
    <p>
    </p>
  </div>
      Pàgina generada amb <a href="http://sphinx-doc.org/">Sphinx</a> amb una lleugera
                                     variació del tema<a
                                     href="https://github.com/snide/sphinx_rtd_theme">
                                         sphinx-rtd-theme </a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'10 març de 2014',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>