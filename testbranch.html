

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>XXX 11.4. Testing and Branching &mdash; Guia Avançada de Programació Bash 10 març de 2014 documentació</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="copyright" title="Copyright" href="copyright.html"/>
    <link rel="top" title="Guia Avançada de Programació Bash 10 març de 2014 documentació" href="index.html"/>
        <link rel="up" title="XXX Part 3. Beyond the Basics" href="part3.html"/>
        <link rel="next" title="XXX Chapter 12. Substitució de comanda" href="commandsub.html"/>
        <link rel="prev" title="XXX 11.3. Loop Control" href="loopcontrol.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Guia Avançada de Programació Bash
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Cercar..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="part1.html">Part 1. Introducció</a></li>
<li class="toctree-l1"><a class="reference internal" href="part2.html">Part 2. Conceptes bàsics</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="part3.html">XXX Part 3. Beyond the Basics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="variables2.html">XXX  Chapter 9. Another Look at Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="internalvariables.html">XXX  9.1. Internal Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="declareref.html">XXX  9.2. Typing variables: <strong>declare</strong> or <strong>typeset</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="randomvar.html">XXX  9.3. $RANDOM: generate random integer</a></li>
<li class="toctree-l2"><a class="reference internal" href="manipulatingvars.html">XXX  Chapter 10. Manipulating Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="string-manipulation.html">XXX  10.1. Manipulating Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameter-substitution.html">XXX 10.2. Substitució de paràmetres</a></li>
<li class="toctree-l2"><a class="reference internal" href="loops.html">Chapter 11. Loops and Branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="loops1.html">XXX  11.1. Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="nestedloops.html">XXX  11.2. Nested Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="loopcontrol.html">XXX  11.3. Loop Control</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">XXX  11.4. Testing and Branching</a></li>
<li class="toctree-l2"><a class="reference internal" href="commandsub.html">XXX  Chapter 12. Substitució de comanda</a></li>
<li class="toctree-l2"><a class="reference internal" href="arithexp.html">XXX  Chapter 13. Arithmetic Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="recess-time.html">XXX  Chapter 14. Recess Time</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="part4.html">XXX Part 4. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="part5.html">XXX Part 5. Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="endnotes.html">Notes finals</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">XXX  Bibliografia</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Guia Avançada de Programació Bash</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Inici</a> &raquo;</li>
      
          <li><a href="part3.html">XXX Part 3. Beyond the Basics</a> &raquo;</li>
      
    <li>XXX  11.4. Testing and Branching</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="xxx-11-4-testing-and-branching">
<h1>XXX  11.4. Testing and Branching<a class="headerlink" href="#xxx-11-4-testing-and-branching" title="Link permanent a aquest títol">¶</a></h1>
<p>The <strong>case</strong> and <strong>select</strong> constructs are technically not loops, since
they do not iterate the execution of a code block. Like loops, however,
they direct program flow according to conditions at the top or bottom of
the block.</p>
<p>** Controlling program flow in a code block**</p>
<blockquote>
<div><dl class="docutils">
<dt><strong>case (in) / esac</strong></dt>
<dd>The <strong>case</strong> construct is the shell scripting analog to
``                   switch                 `` in <strong>C/C++</strong> . It
permits branching to one of a number of code blocks, depending on
condition tests. It serves as a kind of shorthand for multiple
if/then/else statements and is an appropriate tool for creating
menus.</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><strong>case</strong> &#8220;$ ``                   variable                 `` &#8221; in</dt>
<dd>&#8220;$ ``                   condition1                 `` &#8221; )
``                   command                 `` ...
;;
&#8220;$ ``                   condition2                 `` &#8221; )
``                   command                 `` ...
;;
<strong>esac</strong></dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<ul class="last simple">
<li>Quoting the variables is not mandatory, since word splitting does
not take place.</li>
<li>Each test line ends with a right paren <strong>)</strong> . ` [1]
&lt;testbranch.html#FTN.AEN7087&gt;`__</li>
<li>Each condition block ends with a <em>double</em> semicolon ;; .</li>
<li>If a condition tests <em>true</em> , then the associated commands
execute and the <strong>case</strong> block terminates.</li>
<li>The entire <strong>case</strong> block ends with an <strong>esac</strong> ( <em>case</em> spelled
backwards).</li>
</ul>
</div>
<div class="section" id="exemple-25-using-case">
<h2>Exemple 25. Using <em>case</em><a class="headerlink" href="#exemple-25-using-case" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># Testing ranges of characters.</span>

<span class="nb">echo</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;Hit a key, then hit return.&quot;</span>
<span class="nb">read </span>Keypress

<span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$Keypress</span><span class="s2">&quot;</span> in
  <span class="o">[[</span>:lower:<span class="o">]]</span>   <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Lowercase letter&quot;</span><span class="p">;;</span>
  <span class="o">[[</span>:upper:<span class="o">]]</span>   <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Uppercase letter&quot;</span><span class="p">;;</span>
  <span class="o">[</span>0-9<span class="o">]</span>         <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Digit&quot;</span><span class="p">;;</span>
  *             <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Punctuation, whitespace, or other&quot;</span><span class="p">;;</span>
<span class="k">esac</span>      <span class="c">#  Allows ranges of characters in [square brackets],</span>
          <span class="c">#+ or POSIX ranges in [[double square brackets.</span>

<span class="c">#  In the first version of this example,</span>
<span class="c">#+ the tests for lowercase and uppercase characters were</span>
<span class="c">#+ [a-z] and [A-Z].</span>
<span class="c">#  This no longer works in certain locales and/or Linux distros.</span>
<span class="c">#  POSIX is more portable.</span>
<span class="c">#  Thanks to Frank Wang for pointing this out.</span>

<span class="c">#  Exercise:</span>
<span class="c">#  --------</span>
<span class="c">#  As the script stands, it accepts a single keystroke, then terminates.</span>
<span class="c">#  Change the script so it accepts repeated input,</span>
<span class="c">#+ reports on each keystroke, and terminates only when &quot;X&quot; is hit.</span>
<span class="c">#  Hint: enclose everything in a &quot;while&quot; loop.</span>

<span class="nb">exit </span>0
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="exemple-26-creating-menus-using-case">
<h2>Exemple 26. Creating menus using <em>case</em><a class="headerlink" href="#exemple-26-creating-menus-using-case" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="c"># Crude address database</span>

clear <span class="c"># Clear the screen.</span>

<span class="nb">echo</span> <span class="s2">&quot;          Contact List&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;          ------- ----&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Choose one of the following persons:&quot;</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;[E]vans, Roland&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;[J]ones, Mildred&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;[S]mith, Julie&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;[Z]ane, Morris&quot;</span>
<span class="nb">echo</span>

<span class="nb">read </span>person

<span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$person</span><span class="s2">&quot;</span> in
<span class="c"># Note variable is quoted.</span>

  <span class="s2">&quot;E&quot;&quot;e&quot;</span> <span class="o">)</span>
  <span class="c"># Accept upper or lowercase input.</span>
  <span class="nb">echo</span>
<span class="nb">  echo</span> <span class="s2">&quot;Roland Evans&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;4321 Flash Dr.&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Hardscrabble, CO 80753&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;(303) 734-9874&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;(303) 734-9892 fax&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;revans@zzy.net&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Business partner &amp; old friend&quot;</span>
  <span class="p">;;</span>
<span class="c"># Note double semicolon to terminate each option.</span>

  <span class="s2">&quot;J&quot;&quot;j&quot;</span> <span class="o">)</span>
  <span class="nb">echo</span>
<span class="nb">  echo</span> <span class="s2">&quot;Mildred Jones&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;249 E. 7th St., Apt. 19&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;New York, NY 10009&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;(212) 533-2814&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;(212) 533-9972 fax&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;milliej@loisaida.com&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Ex-girlfriend&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Birthday: Feb. 11&quot;</span>
  <span class="p">;;</span>

<span class="c"># Add info for Smith &amp; Zane later.</span>

          * <span class="o">)</span>
   <span class="c"># Default option.</span>
   <span class="c"># Empty input (hitting RETURN) fits here, too.</span>
   <span class="nb">echo</span>
<span class="nb">   echo</span> <span class="s2">&quot;Not yet in database.&quot;</span>
  <span class="p">;;</span>

<span class="k">esac</span>

<span class="nb">echo</span>

<span class="c">#  Exercise:</span>
<span class="c">#  --------</span>
<span class="c">#  Change the script so it accepts multiple inputs,</span>
<span class="c">#+ instead of terminating after displaying just one address.</span>

<span class="nb">exit </span>0
</pre></div>
</div>
<p>An exceptionally clever use of <strong>case</strong> involves testing for
command-line parameters.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c">#! /bin/bash</span>

<span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in
  <span class="s2">&quot;&quot;</span><span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Usage: </span><span class="si">${</span><span class="nv">0</span><span class="p">##*/</span><span class="si">}</span><span class="s2"> &lt;filename&gt;&quot;</span><span class="p">;</span> <span class="nb">exit</span> <span class="nv">$E_PARAM</span><span class="p">;;</span>
                      <span class="c"># No command-line parameters,</span>
                      <span class="c"># or first parameter empty.</span>
<span class="c"># Note that ${0##*/} is ${var##pattern} param substitution.</span>
                      <span class="c"># Net result is $0.</span>

  -*<span class="o">)</span> <span class="nv">FILENAME</span><span class="o">=</span>./<span class="nv">$1</span><span class="p">;;</span>   <span class="c">#  If filename passed as argument ($1)</span>
                      <span class="c">#+ starts with a dash,</span>
                      <span class="c">#+ replace it with ./$1</span>
                      <span class="c">#+ so further commands don&#39;t interpret it</span>
                      <span class="c">#+ as an option.</span>

  * <span class="o">)</span> <span class="nv">FILENAME</span><span class="o">=</span><span class="nv">$1</span><span class="p">;;</span>     <span class="c"># Otherwise, $1.</span>
<span class="k">esac</span>
</pre></div>
</div>
<p>Here is a more straightforward example of command-line parameter
handling:</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c">#! /bin/bash</span>


<span class="k">while</span> <span class="o">[</span> <span class="nv">$# </span>-gt <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">do</span>    <span class="c"># Until you run out of parameters . . .</span>
  <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in
    -d<span class="p">|</span>--debug<span class="o">)</span>
              <span class="c"># &quot;-d&quot; or &quot;--debug&quot; parameter?</span>
              <span class="nv">DEBUG</span><span class="o">=</span>1
              <span class="p">;;</span>
    -c<span class="p">|</span>--conf<span class="o">)</span>
              <span class="nv">CONFFILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
              <span class="nb">shift</span>
<span class="nb">              </span><span class="k">if</span> <span class="o">[</span> ! -f <span class="nv">$CONFFILE</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;Error: Supplied file doesn&#39;t exist!&quot;</span>
                <span class="nb">exit</span> <span class="nv">$E_CONFFILE</span>     <span class="c"># File not found error.</span>
              <span class="k">fi</span>
              <span class="p">;;</span>
  <span class="k">esac</span>
  <span class="nb">shift</span>       <span class="c"># Check next set of parameters.</span>
<span class="k">done</span>

<span class="c">#  From Stefano Falsetto&#39;s &quot;Log2Rot&quot; script,</span>
<span class="c">#+ part of his &quot;rottlog&quot; package.</span>
<span class="c">#  Used with permission.</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="exemple-27-using-command-substitution-to-generate-the-case-variable">
<h2>Exemple 27. Using <em>command substitution</em> to generate the <em>case</em> variable<a class="headerlink" href="#exemple-27-using-command-substitution-to-generate-the-case-variable" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># case-cmd.sh: Using command substitution to generate a &quot;case&quot; variable.</span>

<span class="k">case</span> <span class="k">$(</span> arch <span class="k">)</span> in   <span class="c"># $( arch ) returns machine architecture.</span>
                    <span class="c"># Equivalent to &#39;uname -m&#39; ...</span>
  i386 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80386-based machine&quot;</span><span class="p">;;</span>
  i486 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80486-based machine&quot;</span><span class="p">;;</span>
  i586 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium-based machine&quot;</span><span class="p">;;</span>
  i686 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium2+-based machine&quot;</span><span class="p">;;</span>
  *    <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Other type of machine&quot;</span><span class="p">;;</span>
<span class="k">esac</span>

<span class="nb">exit </span>0
</pre></div>
</div>
<p>A <strong>case</strong> construct can filter strings for
<a class="reference external" href="globbingref.html">globbing</a> patterns.</p>
</div></blockquote>
</div>
<div class="section" id="exemple-28-simple-string-matching">
<h2>Exemple 28. Simple string matching<a class="headerlink" href="#exemple-28-simple-string-matching" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># match-string.sh: Simple string matching</span>
<span class="c">#                  using a &#39;case&#39; construct.</span>

match_string <span class="o">()</span>
<span class="o">{</span> <span class="c"># Exact string match.</span>
  <span class="nv">MATCH</span><span class="o">=</span>0
  <span class="nv">E_NOMATCH</span><span class="o">=</span>90
  <span class="nv">PARAMS</span><span class="o">=</span><span class="m">2</span>     <span class="c"># Function requires 2 arguments.</span>
  <span class="nv">E_BAD_PARAMS</span><span class="o">=</span>91

  <span class="o">[</span> <span class="nv">$# </span>-eq <span class="nv">$PARAMS</span> <span class="o">]</span> <span class="p">|</span><span class="k">return</span> <span class="nv">$E_BAD_PARAMS</span>

  <span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in
  <span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span><span class="o">)</span> <span class="k">return</span> <span class="nv">$MATCH</span><span class="p">;;</span>
  *   <span class="o">)</span> <span class="k">return</span> <span class="nv">$E_NOMATCH</span><span class="p">;;</span>
  <span class="k">esac</span>

<span class="o">}</span>


<span class="nv">a</span><span class="o">=</span>one
<span class="nv">b</span><span class="o">=</span>two
<span class="nv">c</span><span class="o">=</span>three
<span class="nv">d</span><span class="o">=</span>two


match_string <span class="nv">$a</span>     <span class="c"># wrong number of parameters</span>
<span class="nb">echo</span> <span class="nv">$?</span>             <span class="c"># 91</span>

match_string <span class="nv">$a</span> <span class="nv">$b</span>  <span class="c"># no match</span>
<span class="nb">echo</span> <span class="nv">$?</span>             <span class="c"># 90</span>

match_string <span class="nv">$b</span> <span class="nv">$d</span>  <span class="c"># match</span>
<span class="nb">echo</span> <span class="nv">$?</span>             <span class="c"># 0</span>


<span class="nb">exit </span>0
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="exemple-29-checking-for-alphabetic-input">
<h2>Exemple 29. Checking for alphabetic input<a class="headerlink" href="#exemple-29-checking-for-alphabetic-input" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># isalpha.sh: Using a &quot;case&quot; structure to filter a string.</span>

<span class="nv">SUCCESS</span><span class="o">=</span>0
<span class="nv">FAILURE</span><span class="o">=</span><span class="m">1</span>   <span class="c">#  Was FAILURE=-1,</span>
            <span class="c">#+ but Bash no longer allows negative return value.</span>

isalpha <span class="o">()</span>  <span class="c"># Tests whether *first character* of input string is alphabetic.</span>
<span class="o">{</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">]</span>                <span class="c"># No argument passed?</span>
<span class="k">then</span>
  <span class="k">return</span> <span class="nv">$FAILURE</span>
<span class="k">fi</span>

<span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> in
  <span class="o">[</span>a-zA-Z<span class="o">]</span>*<span class="o">)</span> <span class="k">return</span> <span class="nv">$SUCCESS</span><span class="p">;;</span>  <span class="c"># Begins with a letter?</span>
  *        <span class="o">)</span> <span class="k">return</span> <span class="nv">$FAILURE</span><span class="p">;;</span>
<span class="k">esac</span>
<span class="o">}</span>             <span class="c"># Compare this with &quot;isalpha ()&quot; function in C.</span>


isalpha2 <span class="o">()</span>   <span class="c"># Tests whether *entire string* is alphabetic.</span>
<span class="o">{</span>
  <span class="o">[</span> <span class="nv">$# </span>-eq <span class="m">1</span> <span class="o">]</span> <span class="p">|</span><span class="k">return</span> <span class="nv">$FAILURE</span>

  <span class="k">case</span> <span class="nv">$1</span> in
  *<span class="o">[</span>!a-zA-Z<span class="o">]</span>*<span class="p">|</span><span class="s2">&quot;&quot;</span><span class="o">)</span> <span class="k">return</span> <span class="nv">$FAILURE</span><span class="p">;;</span>
               *<span class="o">)</span> <span class="k">return</span> <span class="nv">$SUCCESS</span><span class="p">;;</span>
  <span class="k">esac</span>
<span class="o">}</span>

isdigit <span class="o">()</span>    <span class="c"># Tests whether *entire string* is numerical.</span>
<span class="o">{</span>             <span class="c"># In other words, tests for integer variable.</span>
  <span class="o">[</span> <span class="nv">$# </span>-eq <span class="m">1</span> <span class="o">]</span> <span class="p">|</span><span class="k">return</span> <span class="nv">$FAILURE</span>

  <span class="k">case</span> <span class="nv">$1</span> in
    *<span class="o">[</span>!0-9<span class="o">]</span>*<span class="p">|</span><span class="s2">&quot;&quot;</span><span class="o">)</span> <span class="k">return</span> <span class="nv">$FAILURE</span><span class="p">;;</span>
              *<span class="o">)</span> <span class="k">return</span> <span class="nv">$SUCCESS</span><span class="p">;;</span>
  <span class="k">esac</span>
<span class="o">}</span>



check_var <span class="o">()</span>  <span class="c"># Front-end to isalpha ().</span>
<span class="o">{</span>
<span class="k">if</span> isalpha <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; begins with an alpha character.&quot;</span>
  <span class="k">if</span> isalpha2 <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
  <span class="k">then</span>        <span class="c"># No point in testing if first char is non-alpha.</span>
    <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; contains only alpha characters.&quot;</span>
  <span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; contains at least one non-alpha character.&quot;</span>
  <span class="k">fi</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; begins with a non-alpha character.&quot;</span>
              <span class="c"># Also &quot;non-alpha&quot; if no argument passed.</span>
<span class="k">fi</span>

<span class="nb">echo</span>

<span class="o">}</span>

digit_check <span class="o">()</span>  <span class="c"># Front-end to isdigit ().</span>
<span class="o">{</span>
<span class="k">if</span> isdigit <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; contains only digits [0 - 9].&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;\&quot;</span><span class="nv">$*</span><span class="s2">\&quot; has at least one non-digit character.&quot;</span>
<span class="k">fi</span>

<span class="nb">echo</span>

<span class="o">}</span>

<span class="nv">a</span><span class="o">=</span>23skidoo
<span class="nv">b</span><span class="o">=</span>H3llo
<span class="nv">c</span><span class="o">=</span>-What?
<span class="nv">d</span><span class="o">=</span>What?
<span class="nv">e</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$b</span><span class="k">)</span>   <span class="c"># Command substitution.</span>
<span class="nv">f</span><span class="o">=</span>AbcDef
<span class="nv">g</span><span class="o">=</span>27234
<span class="nv">h</span><span class="o">=</span>27a34
<span class="nv">i</span><span class="o">=</span>27.34

check_var <span class="nv">$a</span>
check_var <span class="nv">$b</span>
check_var <span class="nv">$c</span>
check_var <span class="nv">$d</span>
check_var <span class="nv">$e</span>
check_var <span class="nv">$f</span>
check_var     <span class="c"># No argument passed, so what happens?</span>
<span class="c">#</span>
digit_check <span class="nv">$g</span>
digit_check <span class="nv">$h</span>
digit_check <span class="nv">$i</span>


<span class="nb">exit </span><span class="m">0</span>        <span class="c"># Script improved by S.C.</span>

<span class="c"># Exercise:</span>
<span class="c"># --------</span>
<span class="c">#  Write an &#39;isfloat ()&#39; function that tests for floating point numbers.</span>
<span class="c">#  Hint: The function duplicates &#39;isdigit ()&#39;,</span>
<span class="c">#+ but adds a test for a mandatory decimal point.</span>
</pre></div>
</div>
</div></blockquote>
<dl class="docutils">
<dt><strong>select</strong></dt>
<dd>The <strong>select</strong> construct, adopted from the Korn Shell, is yet
another tool for building menus.</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><strong>select</strong> ``                   variable                 `` [in</dt>
<dd><blockquote class="first">
<div>``                   list                 `` ]</div></blockquote>
<p>do
``                   command                 `` ...
break
done</p>
<blockquote class="last">
<div>This prompts the user to enter one of the choices presented in the
variable list. Note that <strong>select</strong> uses the
``         $PS3        `` prompt ( ``         #?        `` ) by
default, but this may be changed.</div></blockquote>
</dd>
</dl>
</div>
<div class="section" id="exemple-30-creating-menus-using-select">
<h2>Exemple 30. Creating menus using <em>select</em><a class="headerlink" href="#exemple-30-creating-menus-using-select" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="nv">PS3</span><span class="o">=</span><span class="s1">&#39;Choose your favorite vegetable: &#39;</span> <span class="c"># Sets the prompt string.</span>
                                       <span class="c"># Otherwise it defaults to #? .</span>

<span class="nb">echo</span>

<span class="k">select</span> vegetable in <span class="s2">&quot;beans&quot;</span> <span class="s2">&quot;carrots&quot;</span> <span class="s2">&quot;potatoes&quot;</span> <span class="s2">&quot;onions&quot;</span> <span class="s2">&quot;rutabagas&quot;</span>
<span class="k">do</span>
  <span class="nb">echo</span>
<span class="nb">  echo</span> <span class="s2">&quot;Your favorite veggie is </span><span class="nv">$vegetable</span><span class="s2">.&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Yuck!&quot;</span>
  <span class="nb">echo</span>
<span class="nb">  break</span>  <span class="c"># What happens if there is no &#39;break&#39; here?</span>
<span class="k">done</span>

<span class="nb">exit</span>

<span class="c"># Exercise:</span>
<span class="c"># --------</span>
<span class="c">#  Fix this script to accept user input not specified in</span>
<span class="c">#+ the &quot;select&quot; statement.</span>
<span class="c">#  For example, if the user inputs &quot;peas,&quot;</span>
<span class="c">#+ the script would respond &quot;Sorry. That is not on the menu.&quot;</span>
</pre></div>
</div>
<p>If
``                   in                                 list                     ``
is omitted, then <strong>select</strong> uses the list of command line arguments
( ``         $&#64;        `` ) passed to the script or the function
containing the <strong>select</strong> construct.</p>
<p>Compare this to the behavior of a</p>
<p><strong>for</strong> ``                   variable                 `` [in
``                   list                 `` ]</p>
<p>construct with the
``                 in                              list                   ``
omitted.</p>
</div></blockquote>
</div>
<div class="section" id="exemple-31-creating-menus-using-select-in-a-function">
<h2>Exemple 31. Creating menus using <em>select</em> in a function<a class="headerlink" href="#exemple-31-creating-menus-using-select-in-a-function" title="Link permanent a aquest títol">¶</a></h2>
<blockquote>
<div><div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="nv">PS3</span><span class="o">=</span><span class="s1">&#39;Choose your favorite vegetable: &#39;</span>

<span class="nb">echo</span>

choice_of<span class="o">()</span>
<span class="o">{</span>
<span class="k">select</span> vegetable
<span class="c"># [in list] omitted, so &#39;select&#39; uses arguments passed to function.</span>
<span class="k">do</span>
  <span class="nb">echo</span>
<span class="nb">  echo</span> <span class="s2">&quot;Your favorite veggie is </span><span class="nv">$vegetable</span><span class="s2">.&quot;</span>
  <span class="nb">echo</span> <span class="s2">&quot;Yuck!&quot;</span>
  <span class="nb">echo</span>
<span class="nb">  break</span>
<span class="k">done</span>
<span class="o">}</span>

choice_of beans rice carrots radishes rutabaga spinach
<span class="c">#         $1    $2   $3      $4       $5       $6</span>
<span class="c">#         passed to choice_of() function</span>

<span class="nb">exit </span>0
</pre></div>
</div>
<p>See also <a class="reference external" href="bashver2.html#RESISTOR">Example 37-3</a> .</p>
</div></blockquote>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link permanent a aquest títol">¶</a></h3>
<p>` [1]  &lt;testbranch.html#AEN7087&gt;`__</p>
<p>Pattern-match lines may also <em>start</em> with a <strong>(</strong> left paren to give the
layout a more structured appearance.</p>
<hr class="docutils" />
<div class="highlight-sh"><div class="highlight"><pre><span class="k">case</span> <span class="k">$(</span> arch <span class="k">)</span> in
</pre></div>
</div>
<p># $( arch ) returns mach
ine architecture.</p>
<blockquote>
<div>( i386 ) echo &#8220;803</div></blockquote>
<dl class="docutils">
<dt>86-based machine&#8221;;;</dt>
<dd><dl class="first last docutils">
<dt># ^      ^</dt>
<dd>( i486 ) echo &#8220;804</dd>
</dl>
</dd>
<dt>86-based machine&#8221;;;</dt>
<dd>( i586 ) echo &#8220;Pen</dd>
<dt>tium-based machine&#8221;;;</dt>
<dd>( i686 ) echo &#8220;Pen</dd>
<dt>tium2+-based machine&#8221;;;</dt>
<dd>(    * ) echo &#8220;Oth</dd>
<dt>er type of machine&#8221;;;</dt>
<dd>esac</dd>
</dl>
<hr class="docutils" />
<div class="highlight-sh"><div class="highlight"><pre><span class="k">case</span> <span class="k">$(</span> arch <span class="k">)</span> in   <span class="c"># $( arch ) returns machine architecture.</span>
  <span class="o">(</span> i386 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80386-based machine&quot;</span><span class="p">;;</span>
<span class="c"># ^      ^</span>
  <span class="o">(</span> i486 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80486-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span> i586 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span> i686 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium2+-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span>    * <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Other type of machine&quot;</span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
<div class="highlight-sh"><div class="highlight"><pre><span class="k">case</span> <span class="k">$(</span> arch <span class="k">)</span> in   <span class="c"># $( arch ) returns machine architecture.</span>
  <span class="o">(</span> i386 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80386-based machine&quot;</span><span class="p">;;</span>
<span class="c"># ^      ^</span>
  <span class="o">(</span> i486 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;80486-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span> i586 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span> i686 <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Pentium2+-based machine&quot;</span><span class="p">;;</span>
  <span class="o">(</span>    * <span class="o">)</span> <span class="nb">echo</span> <span class="s2">&quot;Other type of machine&quot;</span><span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  <hr/>

  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="commandsub.html" class="btn btn-neutral float-right" title="XXX Chapter 12. Substitució de comanda" accesskey="n">Seg <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="loopcontrol.html" class="btn btn-neutral" title="XXX 11.3. Loop Control"
                                                            accesskey="p"><span class="fa fa-arrow-circle-left"></span> Ant</a>
      
    </div>
  

  <div role="contentinfo">
    <p>
    </p>
  </div>
      Pàgina generada amb <a href="http://sphinx-doc.org/">Sphinx</a> amb una lleugera
                                     variació del tema<a
                                     href="https://github.com/snide/sphinx_rtd_theme">
                                         sphinx-rtd-theme </a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'10 març de 2014',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>