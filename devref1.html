

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>XX1 /dev &mdash; Guia Avançada de Programació Bash 10 març de 2014 documentació</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="copyright" title="Copyright" href="copyright.html"/>
    <link rel="top" title="Guia Avançada de Programació Bash 10 març de 2014 documentació" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Guia Avançada de Programació Bash
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Cercar..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="part1.html">Part 1. Introducció</a></li>
<li class="toctree-l1"><a class="reference internal" href="part2.html">Part 2. Conceptes bàsics</a></li>
<li class="toctree-l1"><a class="reference internal" href="part3.html">XXX Part 3. Beyond the Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="part4.html">XXX Part 4. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="part5.html">XXX Part 5. Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="endnotes.html">Notes finals</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">XXX  Bibliografia</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Guia Avançada de Programació Bash</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Inici</a> &raquo;</li>
      
    <li>XX1 <code class="docutils literal"><span class="pre">/dev</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="xx1-dev">
<h1>XX1 <code class="docutils literal"><span class="pre">/dev</span></code><a class="headerlink" href="#xx1-dev" title="Link permanent a aquest títol">¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">/dev</span></code> directory contains entries for the <em>physical devices</em> that
may or may not be present in the hardware.
<a class="reference external" href="devref1.html#FTN.AEN19045">[1]</a> Appropriately enough, these are
called <em>device files</em>. As an example, the hard drive partitions
containing the mounted filesystem(s) have entries in <code class="docutils literal"><span class="pre">/dev</span></code>, as
<a class="reference external" href="system.html#DFREF">df</a> shows.</p>
<div class="highlight-sh"><div class="highlight"><pre>bash<span class="nv">$ </span>df
Filesystem           1k-blocks      Used Available Use%
 Mounted on
 /dev/hda6               <span class="m">495876</span>    <span class="m">222748</span>    <span class="m">247527</span>  48% /
 /dev/hda1                <span class="m">50755</span>      <span class="m">3887</span>     <span class="m">44248</span>   9% /boot
 /dev/hda8               <span class="m">367013</span>     <span class="m">13262</span>    <span class="m">334803</span>   4% /home
 /dev/hda5              <span class="m">1714416</span>   <span class="m">1123624</span>    <span class="m">503704</span>  70% /usr
</pre></div>
</div>
<p>Among other things, the <code class="docutils literal"><span class="pre">/dev</span></code> directory contains <em>loopback</em> devices,
such as <code class="docutils literal"><span class="pre">/dev/loop0</span></code>. A loopback device is a gimmick that allows an
ordinary file to be accessed as if it were a block device.
<a class="reference external" href="devref1.html#FTN.AEN19065">[2]</a> This permits mounting an entire
filesystem within a single large file. See <a class="reference external" href="system.html#CREATEFS">Example
17-8</a> and <a class="reference external" href="system.html#ISOMOUNTREF">Example
17-7</a>.</p>
<p>A few of the pseudo-devices in <code class="docutils literal"><span class="pre">/dev</span></code> have other specialized uses,
such as <code class="docutils literal"><span class="pre">/dev/null</span></code> &lt;zeros.html#ZEROSREF&gt;`__,
<code class="docutils literal"><span class="pre">/dev/zero</span></code> &lt;zeros.html#ZEROSREF1&gt;`__,
<code class="docutils literal"><span class="pre">/dev/urandom</span></code> &lt;randomvar.html#URANDOMREF&gt;`__, <code class="docutils literal"><span class="pre">/dev/sda1</span></code> (hard
drive partition), <code class="docutils literal"><span class="pre">/dev/udp</span></code> (<em>User Datagram Packet</em> port), and
<code class="docutils literal"><span class="pre">/dev/tcp</span></code> &lt;devref1.html#DEVTCP&gt;`__.</p>
<p>For instance:</p>
<p>To manually <a class="reference external" href="system.html#MOUNTREF">mount</a> a USB flash drive, append
the following line to <code class="docutils literal"><span class="pre">/etc/fstab</span></code> &lt;system.html#FSTABREF&gt;`__.
<a class="reference external" href="devref1.html#FTN.AEN19093">[3]</a></p>
<div class="highlight-sh"><div class="highlight"><pre>/dev/sda1    /mnt/flashdrive    auto    noauto,user,noatime    <span class="m">0</span> 0
</pre></div>
</div>
<p>(See also <a class="reference external" href="contributed-scripts.html#USBINST">Example A-23</a>.)</p>
<p>Checking whether a disk is in the CD-burner (soft-linked to
<code class="docutils literal"><span class="pre">/dev/hdc</span></code>):</p>
<div class="highlight-sh"><div class="highlight"><pre>head -1 /dev/hdc


<span class="c">#  head: cannot open &#39;/dev/hdc&#39; for reading: No medium found</span>
<span class="c">#  (No disc in the drive.)</span>

<span class="c">#  head: error reading &#39;/dev/hdc&#39;: Input/output error</span>
<span class="c">#  (There is a disk in the drive, but it can&#39;t be read;</span>
<span class="c">#+  possibly it&#39;s an unrecorded CDR blank.)</span>

<span class="c">#  Stream of characters and assorted gibberish</span>
<span class="c">#  (There is a pre-recorded disk in the drive,</span>
<span class="c">#+ and this is raw output -- a stream of ASCII and binary data.)</span>
<span class="c">#  Here we see the wisdom of using &#39;head&#39; to limit the output</span>
<span class="c">#+ to manageable proportions, rather than &#39;cat&#39; or something similar</span>
</pre></div>
</div>
<p>.</p>
<blockquote>
<div>#  Now, it&#8217;s just a matter of checking/parsing the output and taking
#+ appropriate action.</div></blockquote>
<p>When executing a command on a <code class="docutils literal"><span class="pre">/dev/tcp/$host/$port</span></code> pseudo-device
file, Bash opens a TCP connection to the associated <em>socket</em>.</p>
<p>A <em>socket</em> is a
communications node
associated with a
specific I/O port. (This
is analogous to a
<em>hardware socket</em>, or
<em>receptacle</em>, for a
connecting cable.) It
permits data transfer
between hardware devices
on the same machine,
between machines on the
same network, between
machines across
different networks, and,
of course, between
machines at different
locations on the
Internet.</p>
<p>The following examples assume an active Internet connection.</p>
<p>Getting the time from <code class="docutils literal"><span class="pre">nist.gov</span></code>:</p>
<div class="highlight-sh"><div class="highlight"><pre>bash<span class="nv">$ </span>cat &lt;/dev/tcp/time.nist.gov/13
<span class="m">53082</span> 04-03-18 04:26:54 <span class="m">68</span> <span class="m">0</span> <span class="m">0</span> 502.3 UTC<span class="o">(</span>NIST<span class="o">)</span> *
</pre></div>
</div>
<p>[Mark contributed this example.]</p>
<p>Generalizing the above into a script:</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># This script must run with root permissions.</span>

<span class="nv">URL</span><span class="o">=</span><span class="s2">&quot;time.nist.gov/13&quot;</span>

<span class="nv">Time</span><span class="o">=</span><span class="k">$(</span>cat &lt;/dev/tcp/<span class="s2">&quot;</span><span class="nv">$URL</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="nv">UTC</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$Time</span><span class="s2">&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{print$3}&#39;</span><span class="k">)</span>   <span class="c"># Third field is UTC (GMT) t</span>
</pre></div>
</div>
<dl class="docutils">
<dt>ime.</dt>
<dd><p class="first"># Exercise: modify this for different time zones.</p>
<p class="last">echo &#8220;UTC Time = &#8220;$UTC&#8221;&#8220;</p>
</dd>
</dl>
<p>Downloading a URL:</p>
<div class="highlight-sh"><div class="highlight"><pre>bash<span class="nv">$ </span><span class="nb">exec </span>5&lt;&gt;/dev/tcp/www.net.cn/80
bash<span class="nv">$ </span><span class="nb">echo</span> -e <span class="s2">&quot;GET / HTTP/1.0\n&quot;</span> &gt;<span class="p">&amp;</span>5
bash<span class="nv">$ </span>cat &lt;<span class="p">&amp;</span>5
</pre></div>
</div>
<p>[Thanks, Mark and Mihai Maties.]</p>
<div class="section" id="exemple-1-using-dev-tcp-for-troubleshooting">
<h2>Exemple 1. Using <code class="docutils literal"><span class="pre">/dev/tcp</span></code> for troubleshooting<a class="headerlink" href="#exemple-1-using-dev-tcp-for-troubleshooting" title="Link permanent a aquest títol">¶</a></h2>
<div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># dev-tcp.sh: /dev/tcp redirection to check Internet connection.</span>

<span class="c"># Script by Troy Engel.</span>
<span class="c"># Used with permission.</span>

<span class="nv">TCP_HOST</span><span class="o">=</span>news-15.net       <span class="c"># A known spam-friendly ISP.</span>
<span class="nv">TCP_PORT</span><span class="o">=</span><span class="m">80</span>                <span class="c"># Port 80 is http.</span>

<span class="c"># Try to connect. (Somewhat similar to a &#39;ping&#39; . . .)</span>
<span class="nb">echo</span> <span class="s2">&quot;HEAD / HTTP/1.0&quot;</span> &gt;/dev/tcp/<span class="si">${</span><span class="nv">TCP_HOST</span><span class="si">}</span>/<span class="si">${</span><span class="nv">TCP_PORT</span><span class="si">}</span>
<span class="nv">MYEXIT</span><span class="o">=</span><span class="nv">$?</span>

: &lt;&lt;EXPLANATION
If bash was compiled with --enable-net-redirections, it has the capa
</pre></div>
</div>
<dl class="docutils">
<dt>bility of</dt>
<dd>using a special character device for both TCP and UDP redirections.</dd>
<dt>These</dt>
<dd><blockquote class="first">
<div>redirections are used identically as STDIN/STDOUT/STDERR. The device</div></blockquote>
<dl class="last docutils">
<dt>entries</dt>
<dd><p class="first">are 30,36 for /dev/tcp:</p>
<blockquote>
<div>mknod /dev/tcp c 30 36</div></blockquote>
<p>&gt;From the bash reference:
/dev/tcp/host/port</p>
<blockquote class="last">
<div>If host is a valid hostname or Internet address, and port is an</div></blockquote>
</dd>
</dl>
</dd>
<dt>integer</dt>
<dd>port number or service name, Bash attempts to open a TCP connection</dd>
<dt>to the</dt>
<dd><p class="first">corresponding socket.
EXPLANATION</p>
<dl class="docutils">
<dt>if [ &#8220;X$MYEXIT&#8221; = &#8220;X0&#8221; ]; then</dt>
<dd>echo &#8220;Connection successful. Exit code: $MYEXIT&#8221;</dd>
<dt>else</dt>
<dd>echo &#8220;Connection unsuccessful. Exit code: $MYEXIT&#8221;</dd>
</dl>
<p>fi</p>
<p class="last">exit $MYEXIT</p>
</dd>
</dl>
</div>
<div class="section" id="exemple-2-playing-music">
<h2>Exemple 2. Playing music<a class="headerlink" href="#exemple-2-playing-music" title="Link permanent a aquest títol">¶</a></h2>
<div class="highlight-sh"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># music.sh</span>

<span class="c"># Music without external files</span>

<span class="c"># Author: Antonio Macchi</span>
<span class="c"># Used in ABS Guide with permission.</span>


<span class="c">#  /dev/dsp default = 8000 frames per second, 8 bits per frame (1 by</span>
</pre></div>
</div>
<dl class="docutils">
<dt>te),</dt>
<dd><p class="first">#+ 1 channel (mono)</p>
<p class="last">duration=2000       # If 8000 bytes = 1 second, then 2000 = 1/4 seco</p>
</dd>
<dt>nd.</dt>
<dd><p class="first">volume=$&#8217;xc0&#8217;      # Max volume = xff (or x00).
mute=$&#8217;x80&#8217;        # No volume = x80 (the middle).</p>
<p class="last">function mknote ()  # $1=Note Hz in bytes (e.g. A = 440Hz ::
{                   #+ 8000 fps / 440 = 16 :: A = 16 bytes per secon</p>
</dd>
</dl>
<ol class="loweralpha" start="4">
<li><blockquote class="first">
<div><p>for t in <cite>seq 0 $duration</cite>
do</p>
<blockquote>
<div><p>test $(( $t % $1 )) = 0 &amp;&amp; echo -n $volume || echo -n $mute</p>
</div></blockquote>
<p>done</p>
</div></blockquote>
<p>}</p>
<p>e=`mknote 49`
g=`mknote 41`
a=`mknote 36`
b=`mknote 32`
c=`mknote 30`
cis=`mknote 29`
d=`mknote 27`
e2=`mknote 24`
n=`mknote 32767`
# European notation.</p>
<p>echo -n &#8220;$g$e2$d$c$d$c$a$g$n$g$e$n$g$e2$d$c$c$b$c$cis$n$cis$d $n$g$e2$d$c$d$c$a$g$n$g$e$n$g$a$d$c$b$a$b$c&#8221; &gt; /dev/dsp
# dsp = Digital Signal Processor</p>
<p>exit      # A &#8220;bonny&#8221; example of an elegant shell script!</p>
</li>
</ol>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link permanent a aquest títol">¶</a></h3>
<p><a class="reference external" href="devref1.html#AEN19045">[1]</a></p>
<p>The entries in <code class="docutils literal"><span class="pre">/dev</span></code> provide mount points for physical and virtual
devices. These entries use very little drive space.</p>
<p>Some devices, such as <code class="docutils literal"><span class="pre">/dev/null</span></code>, <code class="docutils literal"><span class="pre">/dev/zero</span></code>, and <code class="docutils literal"><span class="pre">/dev/urandom</span></code>
are virtual. They are not actual physical devices and exist only in
software.</p>
<p><a class="reference external" href="devref1.html#AEN19065">[2]</a></p>
<p>A <em>block device</em> reads and/or writes data in chunks, or <em>blocks</em>, in
contrast to a <em>character device</em>, which acesses data in <em>character</em>
units. Examples of block devices are hard drives, CDROM drives, and
flash drives. Examples of character devices are keyboards, modems, sound
cards.</p>
<p><a class="reference external" href="devref1.html#AEN19093">[3]</a></p>
<p>Of course, the mount point <code class="docutils literal"><span class="pre">/mnt/flashdrive</span></code> must exist. If not, then,
as <em>root</em>, <strong>mkdir /mnt/flashdrive</strong>.</p>
<p>To actually mount the drive, use the following command: <strong>mount
/mnt/flashdrive</strong></p>
<p>Newer Linux distros automount flash drives in the <code class="docutils literal"><span class="pre">/media</span></code> directory
without user intervention.</p>
</div>
</div>
</div>


          </div>
          <footer>
  <hr/>

  

  <div role="contentinfo">
    <p>
    </p>
  </div>
      Pàgina generada amb <a href="http://sphinx-doc.org/">Sphinx</a> amb una lleugera
                                     variació del tema<a
                                     href="https://github.com/snide/sphinx_rtd_theme">
                                         sphinx-rtd-theme </a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'10 març de 2014',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>